---
title: 'Vorgehensweise: Sicheres Umwandeln mit Musterabgleich und den Operatoren „is“ und „as“'
description: Erfahren Sie, wie Sie Techniken für den Musterabgleich anwenden, um Variablen sicher in einen anderen Typ umzuwandeln. Sie können sowohl den Musterabgleich als auch die Operatoren „is“ und „as“ verwenden, um Typen sicher umzuwandeln.
ms.date: 09/05/2018
helpviewer_keywords:
- cast operators [C#], as and is operators
- as operator [C#]
- is operator [C#]
ms.openlocfilehash: 60e69a8ef55484e3b04f1674c35a1c5dadfa3b7c
ms.sourcegitcommit: 43cbde34970f5f38f30c43cd63b9c7e2e83717ae
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 04/11/2020
ms.locfileid: "81120997"
---
# <a name="how-to-safely-cast-by-using-pattern-matching-and-the-is-and-as-operators"></a><span data-ttu-id="9de47-104">Vorgehensweise: Sicheres Umwandeln mit Musterabgleich und den Operatoren „is“ und „as“</span><span class="sxs-lookup"><span data-stu-id="9de47-104">How to safely cast by using pattern matching and the is and as operators</span></span>

<span data-ttu-id="9de47-105">Da Objekte polymorph sind, ist es möglich, dass eine Variable eines Basisklassentyps einen abgeleiteten [Typ](../programming-guide/types/index.md) enthalten kann.</span><span class="sxs-lookup"><span data-stu-id="9de47-105">Because objects are polymorphic, it's possible for a variable of a base class type to hold a derived [type](../programming-guide/types/index.md).</span></span> <span data-ttu-id="9de47-106">Für den Zugriff auf die Instanzmember des abgeleiteten Typs ist es erforderlich, dass Sie den Wert wieder in den abgeleiteten Typ [umwandeln](../programming-guide/types/casting-and-type-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="9de47-106">To access the derived type's instance members, it's necessary to [cast](../programming-guide/types/casting-and-type-conversions.md) the value back to the derived type.</span></span> <span data-ttu-id="9de47-107">Allerdings entsteht durch eine Umwandlung das Risiko, eine <xref:System.InvalidCastException>-Ausnahme auszulösen.</span><span class="sxs-lookup"><span data-stu-id="9de47-107">However, a cast creates the risk of throwing an <xref:System.InvalidCastException>.</span></span> <span data-ttu-id="9de47-108">C# stellt [Musterabgleich](../pattern-matching.md)-Anweisungen bereit, die eine Umwandlung unter der Bedingung ausführen, dass sie erfolgreich sein wird.</span><span class="sxs-lookup"><span data-stu-id="9de47-108">C# provides [pattern matching](../pattern-matching.md) statements that perform a cast conditionally only when it will succeed.</span></span> <span data-ttu-id="9de47-109">C# bietet außerdem die Operatoren [is](../language-reference/operators/type-testing-and-cast.md#is-operator) und [as](../language-reference/operators/type-testing-and-cast.md#as-operator), um zu testen, ob ein Wert einen bestimmten Typ aufweist.</span><span class="sxs-lookup"><span data-stu-id="9de47-109">C# also provides the [is](../language-reference/operators/type-testing-and-cast.md#is-operator) and [as](../language-reference/operators/type-testing-and-cast.md#as-operator) operators to test if a value is of a certain type.</span></span>

<span data-ttu-id="9de47-110">Das folgende Beispiel zeigt die Verwendung der `is`-Anweisung zum Musterabgleich:</span><span class="sxs-lookup"><span data-stu-id="9de47-110">The following example shows how to use the pattern matching `is` statement:</span></span>

[!code-csharp[Pattern matching is statement](../../../samples/snippets/csharp/how-to/safelycast/patternmatching/Program.cs#PatternMatchingIs)]

<span data-ttu-id="9de47-111">Im vorhergehenden Beispiel werden einige Features der Syntax für den Musterabgleich veranschaulicht.</span><span class="sxs-lookup"><span data-stu-id="9de47-111">The preceding sample demonstrates a few features of pattern matching syntax.</span></span> <span data-ttu-id="9de47-112">Die `if (a is Mammal m)`-Anweisung kombiniert den Test mit einer Initialisierungszuweisung.</span><span class="sxs-lookup"><span data-stu-id="9de47-112">The `if (a is Mammal m)` statement combines the test with an initialization assignment.</span></span> <span data-ttu-id="9de47-113">Die Zuweisung tritt nur auf, wenn der Test erfolgreich ist.</span><span class="sxs-lookup"><span data-stu-id="9de47-113">The assignment occurs only when the test succeeds.</span></span> <span data-ttu-id="9de47-114">Die Variable `m` befindet sich nur im Bereich der eingebetteten `if`-Anweisung, dem sie zugewiesen wurde.</span><span class="sxs-lookup"><span data-stu-id="9de47-114">The variable `m` is only in scope in the embedded `if` statement where it has been assigned.</span></span> <span data-ttu-id="9de47-115">Sie können in der gleichen Methode später nicht auf `m` zugreifen.</span><span class="sxs-lookup"><span data-stu-id="9de47-115">You cannot access `m` later in the same method.</span></span> <span data-ttu-id="9de47-116">Das vorstehende Beispiel zeigt auch, wie der [`as`-Operator](../language-reference/operators/type-testing-and-cast.md#as-operator) zum Konvertieren eines Objekts in einen bestimmten Typ verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="9de47-116">The preceding example also shows how to use the [`as` operator](../language-reference/operators/type-testing-and-cast.md#as-operator) to convert an object to a specified type.</span></span>

<span data-ttu-id="9de47-117">Sie können mithilfe der gleichen Syntax testen, ob ein [Nullable-Werttyp](../language-reference/builtin-types/nullable-value-types.md) einen Wert aufweist, wie im folgenden Beispiel gezeigt:</span><span class="sxs-lookup"><span data-stu-id="9de47-117">You can also use the same syntax for testing if a [nullable value type](../language-reference/builtin-types/nullable-value-types.md) has a value, as shown in the following example:</span></span>

[!code-csharp[Pattern matching with nullable types](../../../samples/snippets/csharp/how-to/safelycast/nullablepatternmatching/Program.cs#PatternMatchingNullable)]

<span data-ttu-id="9de47-118">Im vorhergehenden Beispiel werden weitere Features des Musterabgleichs veranschaulicht, die mit Konvertierungen verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="9de47-118">The preceding sample demonstrates other features of pattern matching to use with conversions.</span></span> <span data-ttu-id="9de47-119">Sie können eine Variable für das NULL-Muster prüfen, indem Sie spezifisch nach dem `null`-Wert sehen.</span><span class="sxs-lookup"><span data-stu-id="9de47-119">You can test a variable for the null pattern by checking specifically for the `null` value.</span></span> <span data-ttu-id="9de47-120">Wenn der Laufzeitwert der Variable `null` ist, gibt eine `is`-Anweisung, die nach einem Typ prüft, immer `false` zurück.</span><span class="sxs-lookup"><span data-stu-id="9de47-120">When the runtime value of the variable is `null`, an `is` statement checking for a type always returns `false`.</span></span> <span data-ttu-id="9de47-121">Die `is`-Anweisung für den Musterabgleich lässt keinen Nullable-Typ für den Wert zu, z.B. `int?` oder `Nullable<int>`, jedoch können Sie nach jedem anderen Werttyp prüfen.</span><span class="sxs-lookup"><span data-stu-id="9de47-121">The pattern matching `is` statement doesn't allow a nullable value type, such as `int?` or `Nullable<int>`, but you can test for any other value type.</span></span> <span data-ttu-id="9de47-122">Die `is`-Muster aus dem vorherigen Beispiel sind nicht auf die Nullable-Werttypen beschränkt.</span><span class="sxs-lookup"><span data-stu-id="9de47-122">The `is` patterns from the preceding example are not limited to the nullable value types.</span></span> <span data-ttu-id="9de47-123">Sie können diese Muster auch verwenden, um zu testen, ob eine Variable eines Verweistyps über einen Wert oder verfügt oder `null` ist.</span><span class="sxs-lookup"><span data-stu-id="9de47-123">You also can use those patterns to test if a variable of a reference type has a value or it's `null`.</span></span>

<span data-ttu-id="9de47-124">Im vorangegangenen Beispiel wird auch gezeigt, wie Sie das Typmuster in einer `switch`-Anweisung verwenden, bei der die Variable einen von vielen verschiedenen Typen aufweisen kann.</span><span class="sxs-lookup"><span data-stu-id="9de47-124">The preceding sample also shows how you use the type pattern in a `switch` statement where the variable may be one of many different types.</span></span>

<span data-ttu-id="9de47-125">Wenn Sie testen möchten, ob eine Variable einen bestimmten Typ aufweist, Sie aber keine neue Variable zuweisen möchten, können Sie die Operatoren `is` und `as` für Verweistypen und Nullable-Werttypen verwenden.</span><span class="sxs-lookup"><span data-stu-id="9de47-125">If you want to test if a variable is a given type, but not assign it to a new variable, you can use the `is` and `as` operators for reference types and nullable value types.</span></span> <span data-ttu-id="9de47-126">Im folgenden Code wird veranschaulicht, wie Sie die Anweisungen `is` und `as` verwenden, die Teil der C#-Sprache waren, bevor der Musterabgleich eingeführt wurde, um zu überprüfen, ob eine Variable einen bestimmten Typ aufweist:</span><span class="sxs-lookup"><span data-stu-id="9de47-126">The following code shows how to use the `is` and `as` statements that were part of the C# language before pattern matching was introduced to test if a variable is of a given type:</span></span>

[!code-csharp[testing variable types with the is and as statements](../../../samples/snippets/csharp/how-to/safelycast/asandis/Program.cs#IsAndAs)]

<span data-ttu-id="9de47-127">Wie Sie durch Vergleichen dieses Codes mit dem Code für den Musterabgleich sehen können, stellt die Syntax für den Musterabgleich robustere Features bereit, indem der Test und die Zuweisung in einer einzelnen Anweisung kombiniert werden.</span><span class="sxs-lookup"><span data-stu-id="9de47-127">As you can see by comparing this code with the pattern matching code, the pattern matching syntax provides more robust features by combining the test and the assignment in a single statement.</span></span> <span data-ttu-id="9de47-128">Verwenden Sie nach Möglichkeit die Syntax für den Musterabgleich.</span><span class="sxs-lookup"><span data-stu-id="9de47-128">Use the pattern matching syntax whenever possible.</span></span>

<span data-ttu-id="9de47-129">Sie können diese Beispiele ausprobieren, indem Sie sich den Code in unserem [GitHub-Repository](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/how-to/safelycast) ansehen.</span><span class="sxs-lookup"><span data-stu-id="9de47-129">You can try these samples by looking at the code in our [GitHub repository](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/how-to/safelycast).</span></span> <span data-ttu-id="9de47-130">Alternativ dazu können Sie die Beispiele [als ZIP-Datei](../../../samples/snippets/csharp/how-to/safelycast.zip) herunterladen.</span><span class="sxs-lookup"><span data-stu-id="9de47-130">Or you can download the samples [as a zip file](../../../samples/snippets/csharp/how-to/safelycast.zip).</span></span>
