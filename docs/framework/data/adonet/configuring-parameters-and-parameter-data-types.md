---
title: Konfigurieren von Parametern und Parameter Datentypen
description: Befehls Objekte verwenden Parameter, um Werte an SQL-Anweisungen oder gespeicherte Prozeduren zu übergeben, und stellen die Typüberprüfung und Validierung in ADO.net bereit.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: a426eeae785274b0484a84a2fae2dce4572fb4c4
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/02/2020
ms.locfileid: "84287115"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="d5096-103">Konfigurieren von Parametern und Parameter Datentypen</span><span class="sxs-lookup"><span data-stu-id="d5096-103">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="d5096-104">Befehlsobjekte verwenden Parameter, um Werte an SQL-Anweisungen oder gespeicherte Prozeduren zu übergeben, und ermöglichen so Typüberprüfungen und Validierungen.</span><span class="sxs-lookup"><span data-stu-id="d5096-104">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="d5096-105">Im Unterschied zu Befehlstext wird die Parametereingabe als Literalwert und nicht als ausführbarer Code behandelt.</span><span class="sxs-lookup"><span data-stu-id="d5096-105">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="d5096-106">Dies hilft beim Schutz vor SQL Injection-Angriffen, bei denen ein Angreifer einen SQL-Befehl, der die Sicherheit auf dem Server gefährdet, in eine SQL-Anweisung einschleust.</span><span class="sxs-lookup"><span data-stu-id="d5096-106">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="d5096-107">Parametrisierte Befehle können außerdem die Leistung bei der Abfrageausführung verbessern, da sie den Datenbankserver dabei unterstützen, den eingehenden Befehl mit dem richtigen zwischengespeicherten Abfrageplan abzugleichen.</span><span class="sxs-lookup"><span data-stu-id="d5096-107">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="d5096-108">Weitere Informationen finden Sie unter zwischen [Speichern und wieder verwenden von Ausführungsplänen](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) und [Parameter und Wiederverwendung von Ausführungsplänen](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="d5096-108">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="d5096-109">Parametrisierte Befehle sind aber nicht nur aus Sicherheits- und Leistungsgründen vorteilhaft, sondern sie stellen auch eine bequeme Methode zum Organisieren von Werten dar, die an eine Datenquelle übergeben werden.</span><span class="sxs-lookup"><span data-stu-id="d5096-109">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="d5096-110">Ein <xref:System.Data.Common.DbParameter> -Objekt kann mithilfe des zugehörigen Konstruktors erstellt werden, oder es wird durch Aufrufen der <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> -Methode der `Add` -Auflistung zur <xref:System.Data.Common.DbParameterCollection> hinzugefügt.</span><span class="sxs-lookup"><span data-stu-id="d5096-110">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="d5096-111">Die `Add` -Methode verwendet als Eingabe je nach Datenanbieter Konstruktorargumente oder ein vorhandenes Parameterobjekt.</span><span class="sxs-lookup"><span data-stu-id="d5096-111">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="d5096-112">Angeben der ParameterDirection-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="d5096-112">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="d5096-113">Beim Hinzufügen von Parametern müssen Sie für alle Parameter, die keine Eingabeparameter sind, die <xref:System.Data.ParameterDirection> -Eigenschaft bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="d5096-113">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="d5096-114">Die folgende Tabelle zeigt die `ParameterDirection` -Werte, die Sie mit der <xref:System.Data.ParameterDirection> -Enumeration verwenden können.</span><span class="sxs-lookup"><span data-stu-id="d5096-114">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="d5096-115">Membername</span><span class="sxs-lookup"><span data-stu-id="d5096-115">Member name</span></span>|<span data-ttu-id="d5096-116">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="d5096-116">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="d5096-117">Der Parameter ist ein Eingabeparameter.</span><span class="sxs-lookup"><span data-stu-id="d5096-117">The parameter is an input parameter.</span></span> <span data-ttu-id="d5096-118">Dies ist die Standardeinstellung.</span><span class="sxs-lookup"><span data-stu-id="d5096-118">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="d5096-119">Der Parameter kann sowohl für die Eingabe als auch für die Ausgabe verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="d5096-119">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="d5096-120">Der Parameter ist ein Ausgabeparameter.</span><span class="sxs-lookup"><span data-stu-id="d5096-120">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="d5096-121">Der Parameter steht für einen Eingabewert aus einem Vorgang, wie z. B. einer gespeicherten Prozedur, einer integrierten Funktion oder einer benutzerdefinierten Funktion.</span><span class="sxs-lookup"><span data-stu-id="d5096-121">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="d5096-122">Arbeiten mit Parameter Platzhaltern</span><span class="sxs-lookup"><span data-stu-id="d5096-122">Working with parameter placeholders</span></span>

<span data-ttu-id="d5096-123">Die Syntax für Parameterplatzhalter ist abhängig von der jeweiligen Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="d5096-123">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="d5096-124">Die .NET Framework-Datenanbieter handhaben die Benennung und das Angeben von Parametern und Parameterplatzhaltern unterschiedlich.</span><span class="sxs-lookup"><span data-stu-id="d5096-124">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="d5096-125">Diese Syntax wird an eine bestimmte Datenquelle angepasst, wie in der folgenden Tabelle beschrieben.</span><span class="sxs-lookup"><span data-stu-id="d5096-125">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="d5096-126">Datenanbieter</span><span class="sxs-lookup"><span data-stu-id="d5096-126">Data provider</span></span>|<span data-ttu-id="d5096-127">Syntax für Parameterbenennung</span><span class="sxs-lookup"><span data-stu-id="d5096-127">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="d5096-128">Verwendet benannte Parameter im Format `@`*Parametername*.</span><span class="sxs-lookup"><span data-stu-id="d5096-128">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="d5096-129">Verwendet Positionsparametermarker, die durch ein Fragezeichen (`?`) gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="d5096-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="d5096-130">Verwendet Positionsparametermarker, die durch ein Fragezeichen (`?`) gekennzeichnet sind.</span><span class="sxs-lookup"><span data-stu-id="d5096-130">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="d5096-131">Verwendet benannte Parameter im Format `:`*Parametername* (oder *Parametername*).</span><span class="sxs-lookup"><span data-stu-id="d5096-131">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="d5096-132">Angeben von Parameter Datentypen</span><span class="sxs-lookup"><span data-stu-id="d5096-132">Specifying parameter data types</span></span>

<span data-ttu-id="d5096-133">Der Datentyp eines Parameters ist jeweils datenanbieterspezifisch.</span><span class="sxs-lookup"><span data-stu-id="d5096-133">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="d5096-134">Wenn Sie den-Typ angeben, wird der Wert von `Parameter` in den .NET Framework-Daten Anbietertyp konvertiert, bevor der Wert an die Datenquelle übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="d5096-134">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="d5096-135">Der Typ eines `Parameter` kann auch in generischer Form angegeben werden, indem die `DbType` -Eigenschaft des `Parameter` -Objekts auf einen bestimmten <xref:System.Data.DbType>festgelegt wird.</span><span class="sxs-lookup"><span data-stu-id="d5096-135">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="d5096-136">Der .NET Framework Daten Anbietertyp eines- `Parameter` Objekts wird vom .NET Framework-Typ des- `Value` `Parameter` Objekts oder vom `DbType` des-Objekts abgeleitet `Parameter` .</span><span class="sxs-lookup"><span data-stu-id="d5096-136">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="d5096-137">Die folgende Tabelle zeigt den abgeleiteten `Parameter` -Typ basierend auf dem als `Parameter` -Wert übergebenen Objekt oder dem angegebenen `DbType`.</span><span class="sxs-lookup"><span data-stu-id="d5096-137">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="d5096-138">.NET Framework-Typ</span><span class="sxs-lookup"><span data-stu-id="d5096-138">.NET Framework type</span></span>|<span data-ttu-id="d5096-139">DbType</span><span class="sxs-lookup"><span data-stu-id="d5096-139">DbType</span></span>|<span data-ttu-id="d5096-140">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="d5096-140">SqlDbType</span></span>|<span data-ttu-id="d5096-141">OleDbType</span><span class="sxs-lookup"><span data-stu-id="d5096-141">OleDbType</span></span>|<span data-ttu-id="d5096-142">OdbcType</span><span class="sxs-lookup"><span data-stu-id="d5096-142">OdbcType</span></span>|<span data-ttu-id="d5096-143">OracleType</span><span class="sxs-lookup"><span data-stu-id="d5096-143">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="d5096-144">Boolesch</span><span class="sxs-lookup"><span data-stu-id="d5096-144">Boolean</span></span>|<span data-ttu-id="d5096-145">bit</span><span class="sxs-lookup"><span data-stu-id="d5096-145">Bit</span></span>|<span data-ttu-id="d5096-146">Boolesch</span><span class="sxs-lookup"><span data-stu-id="d5096-146">Boolean</span></span>|<span data-ttu-id="d5096-147">bit</span><span class="sxs-lookup"><span data-stu-id="d5096-147">Bit</span></span>|<span data-ttu-id="d5096-148">Byte</span><span class="sxs-lookup"><span data-stu-id="d5096-148">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="d5096-149">Byte</span><span class="sxs-lookup"><span data-stu-id="d5096-149">Byte</span></span>|<span data-ttu-id="d5096-150">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d5096-150">TinyInt</span></span>|<span data-ttu-id="d5096-151">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="d5096-151">UnsignedTinyInt</span></span>|<span data-ttu-id="d5096-152">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d5096-152">TinyInt</span></span>|<span data-ttu-id="d5096-153">Byte</span><span class="sxs-lookup"><span data-stu-id="d5096-153">Byte</span></span>|
|<span data-ttu-id="d5096-154">byte[]</span><span class="sxs-lookup"><span data-stu-id="d5096-154">byte[]</span></span>|<span data-ttu-id="d5096-155">Binary</span><span class="sxs-lookup"><span data-stu-id="d5096-155">Binary</span></span>|<span data-ttu-id="d5096-156">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="d5096-156">VarBinary.</span></span> <span data-ttu-id="d5096-157">Bei dieser impliziten Konvertierung tritt ein Fehler auf, wenn das Bytearray größer als die maximale Größe von varbinary ist, d. h. 8000 Bytes. Für Byte Arrays, die größer als 8000 Bytes sind, legen Sie explizit fest <xref:System.Data.SqlDbType> .</span><span class="sxs-lookup"><span data-stu-id="d5096-157">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="d5096-158">VarBinary</span><span class="sxs-lookup"><span data-stu-id="d5096-158">VarBinary</span></span>|<span data-ttu-id="d5096-159">Binary</span><span class="sxs-lookup"><span data-stu-id="d5096-159">Binary</span></span>|<span data-ttu-id="d5096-160">Raw</span><span class="sxs-lookup"><span data-stu-id="d5096-160">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="d5096-161">Das Ableiten von <xref:System.Data.SqlDbType> aus char wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-161">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="d5096-162">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-162">Char</span></span>|<span data-ttu-id="d5096-163">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-163">Char</span></span>|<span data-ttu-id="d5096-164">Byte</span><span class="sxs-lookup"><span data-stu-id="d5096-164">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="d5096-165">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-165">DateTime</span></span>|<span data-ttu-id="d5096-166">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-166">DateTime</span></span>|<span data-ttu-id="d5096-167">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="d5096-167">DBTimeStamp</span></span>|<span data-ttu-id="d5096-168">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-168">DateTime</span></span>|<span data-ttu-id="d5096-169">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-169">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="d5096-170">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="d5096-170">DateTimeOffset</span></span>|<span data-ttu-id="d5096-171">"DateTimeOffset" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d5096-171">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="d5096-172">Das Ableiten von <xref:System.Data.SqlDbType> aus DateTimeOffset wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-172">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="d5096-173">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-173">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="d5096-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="d5096-174">Decimal</span></span>|<span data-ttu-id="d5096-175">Decimal</span><span class="sxs-lookup"><span data-stu-id="d5096-175">Decimal</span></span>|<span data-ttu-id="d5096-176">Decimal</span><span class="sxs-lookup"><span data-stu-id="d5096-176">Decimal</span></span>|<span data-ttu-id="d5096-177">Numeric</span><span class="sxs-lookup"><span data-stu-id="d5096-177">Numeric</span></span>|<span data-ttu-id="d5096-178">Number</span><span class="sxs-lookup"><span data-stu-id="d5096-178">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="d5096-179">Double</span><span class="sxs-lookup"><span data-stu-id="d5096-179">Double</span></span>|<span data-ttu-id="d5096-180">Float</span><span class="sxs-lookup"><span data-stu-id="d5096-180">Float</span></span>|<span data-ttu-id="d5096-181">Double</span><span class="sxs-lookup"><span data-stu-id="d5096-181">Double</span></span>|<span data-ttu-id="d5096-182">Double</span><span class="sxs-lookup"><span data-stu-id="d5096-182">Double</span></span>|<span data-ttu-id="d5096-183">Double</span><span class="sxs-lookup"><span data-stu-id="d5096-183">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="d5096-184">Single</span><span class="sxs-lookup"><span data-stu-id="d5096-184">Single</span></span>|<span data-ttu-id="d5096-185">Real</span><span class="sxs-lookup"><span data-stu-id="d5096-185">Real</span></span>|<span data-ttu-id="d5096-186">Single</span><span class="sxs-lookup"><span data-stu-id="d5096-186">Single</span></span>|<span data-ttu-id="d5096-187">Real</span><span class="sxs-lookup"><span data-stu-id="d5096-187">Real</span></span>|<span data-ttu-id="d5096-188">Float</span><span class="sxs-lookup"><span data-stu-id="d5096-188">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="d5096-189">Guid</span><span class="sxs-lookup"><span data-stu-id="d5096-189">Guid</span></span>|<span data-ttu-id="d5096-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="d5096-190">UniqueIdentifier</span></span>|<span data-ttu-id="d5096-191">Guid</span><span class="sxs-lookup"><span data-stu-id="d5096-191">Guid</span></span>|<span data-ttu-id="d5096-192">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="d5096-192">UniqueIdentifier</span></span>|<span data-ttu-id="d5096-193">Raw</span><span class="sxs-lookup"><span data-stu-id="d5096-193">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="d5096-194">Int16</span><span class="sxs-lookup"><span data-stu-id="d5096-194">Int16</span></span>|<span data-ttu-id="d5096-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d5096-195">SmallInt</span></span>|<span data-ttu-id="d5096-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d5096-196">SmallInt</span></span>|<span data-ttu-id="d5096-197">SmallInt</span><span class="sxs-lookup"><span data-stu-id="d5096-197">SmallInt</span></span>|<span data-ttu-id="d5096-198">Int16</span><span class="sxs-lookup"><span data-stu-id="d5096-198">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="d5096-199">Int32</span><span class="sxs-lookup"><span data-stu-id="d5096-199">Int32</span></span>|<span data-ttu-id="d5096-200">Int</span><span class="sxs-lookup"><span data-stu-id="d5096-200">Int</span></span>|<span data-ttu-id="d5096-201">Int</span><span class="sxs-lookup"><span data-stu-id="d5096-201">Int</span></span>|<span data-ttu-id="d5096-202">Int</span><span class="sxs-lookup"><span data-stu-id="d5096-202">Int</span></span>|<span data-ttu-id="d5096-203">Int32</span><span class="sxs-lookup"><span data-stu-id="d5096-203">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="d5096-204">Int64</span><span class="sxs-lookup"><span data-stu-id="d5096-204">Int64</span></span>|<span data-ttu-id="d5096-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="d5096-205">BigInt</span></span>|<span data-ttu-id="d5096-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="d5096-206">BigInt</span></span>|<span data-ttu-id="d5096-207">BigInt</span><span class="sxs-lookup"><span data-stu-id="d5096-207">BigInt</span></span>|<span data-ttu-id="d5096-208">Number</span><span class="sxs-lookup"><span data-stu-id="d5096-208">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="d5096-209">Object</span><span class="sxs-lookup"><span data-stu-id="d5096-209">Object</span></span>|<span data-ttu-id="d5096-210">Variant</span><span class="sxs-lookup"><span data-stu-id="d5096-210">Variant</span></span>|<span data-ttu-id="d5096-211">Variant</span><span class="sxs-lookup"><span data-stu-id="d5096-211">Variant</span></span>|<span data-ttu-id="d5096-212">Das Ableiten von OdbcType aus Object wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-212">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="d5096-213">Blob</span><span class="sxs-lookup"><span data-stu-id="d5096-213">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="d5096-214">Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="d5096-214">String</span></span>|<span data-ttu-id="d5096-215">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="d5096-215">NVarChar.</span></span> <span data-ttu-id="d5096-216">Diese implizite Konvertierung kann nicht ausgeführt werden, wenn die Zeichenfolge die maximale NVarChar-Länge (4000 Zeichen) überschreitet.</span><span class="sxs-lookup"><span data-stu-id="d5096-216">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="d5096-217">Legen Sie für Zeichenfolgen mit mehr als 4000 Zeichen explizit <xref:System.Data.SqlDbType>fest.</span><span class="sxs-lookup"><span data-stu-id="d5096-217">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="d5096-218">VarWChar</span><span class="sxs-lookup"><span data-stu-id="d5096-218">VarWChar</span></span>|<span data-ttu-id="d5096-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-219">NVarChar</span></span>|<span data-ttu-id="d5096-220">NVarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-220">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="d5096-221">Zeit</span><span class="sxs-lookup"><span data-stu-id="d5096-221">Time</span></span>|<span data-ttu-id="d5096-222">"Time" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d5096-222">Time in SQL Server 2008.</span></span> <span data-ttu-id="d5096-223">Das Ableiten von <xref:System.Data.SqlDbType> aus TimeSpan wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-223">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d5096-224">DBTime</span><span class="sxs-lookup"><span data-stu-id="d5096-224">DBTime</span></span>|<span data-ttu-id="d5096-225">Time</span><span class="sxs-lookup"><span data-stu-id="d5096-225">Time</span></span>|<span data-ttu-id="d5096-226">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-226">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="d5096-227">UInt16</span><span class="sxs-lookup"><span data-stu-id="d5096-227">UInt16</span></span>|<span data-ttu-id="d5096-228">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt16 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-228">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="d5096-229">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="d5096-229">UnsignedSmallInt</span></span>|<span data-ttu-id="d5096-230">Int</span><span class="sxs-lookup"><span data-stu-id="d5096-230">Int</span></span>|<span data-ttu-id="d5096-231">UInt16</span><span class="sxs-lookup"><span data-stu-id="d5096-231">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="d5096-232">UInt32</span><span class="sxs-lookup"><span data-stu-id="d5096-232">UInt32</span></span>|<span data-ttu-id="d5096-233">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt32 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-233">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="d5096-234">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="d5096-234">UnsignedInt</span></span>|<span data-ttu-id="d5096-235">BigInt</span><span class="sxs-lookup"><span data-stu-id="d5096-235">BigInt</span></span>|<span data-ttu-id="d5096-236">UInt32</span><span class="sxs-lookup"><span data-stu-id="d5096-236">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="d5096-237">UInt64</span><span class="sxs-lookup"><span data-stu-id="d5096-237">UInt64</span></span>|<span data-ttu-id="d5096-238">Das Ableiten von <xref:System.Data.SqlDbType> aus UInt64 wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-238">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="d5096-239">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="d5096-239">UnsignedBigInt</span></span>|<span data-ttu-id="d5096-240">Numerisch</span><span class="sxs-lookup"><span data-stu-id="d5096-240">Numeric</span></span>|<span data-ttu-id="d5096-241">Number</span><span class="sxs-lookup"><span data-stu-id="d5096-241">Number</span></span>|
||<span data-ttu-id="d5096-242">AnsiString</span><span class="sxs-lookup"><span data-stu-id="d5096-242">AnsiString</span></span>|<span data-ttu-id="d5096-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-243">VarChar</span></span>|<span data-ttu-id="d5096-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-244">VarChar</span></span>|<span data-ttu-id="d5096-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-245">VarChar</span></span>|<span data-ttu-id="d5096-246">VarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-246">VarChar</span></span>|
||<span data-ttu-id="d5096-247">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="d5096-247">AnsiStringFixedLength</span></span>|<span data-ttu-id="d5096-248">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-248">Char</span></span>|<span data-ttu-id="d5096-249">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-249">Char</span></span>|<span data-ttu-id="d5096-250">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-250">Char</span></span>|<span data-ttu-id="d5096-251">Char</span><span class="sxs-lookup"><span data-stu-id="d5096-251">Char</span></span>|
||<span data-ttu-id="d5096-252">Währung</span><span class="sxs-lookup"><span data-stu-id="d5096-252">Currency</span></span>|<span data-ttu-id="d5096-253">Money</span><span class="sxs-lookup"><span data-stu-id="d5096-253">Money</span></span>|<span data-ttu-id="d5096-254">Währung</span><span class="sxs-lookup"><span data-stu-id="d5096-254">Currency</span></span>|<span data-ttu-id="d5096-255">Das Ableiten von `OdbcType` aus `Currency` wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-255">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="d5096-256">Number</span><span class="sxs-lookup"><span data-stu-id="d5096-256">Number</span></span>|
||<span data-ttu-id="d5096-257">Datum</span><span class="sxs-lookup"><span data-stu-id="d5096-257">Date</span></span>|<span data-ttu-id="d5096-258">"Date" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d5096-258">Date in SQL Server 2008.</span></span> <span data-ttu-id="d5096-259">Das Ableiten von <xref:System.Data.SqlDbType> aus Date wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-259">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d5096-260">DBDate</span><span class="sxs-lookup"><span data-stu-id="d5096-260">DBDate</span></span>|<span data-ttu-id="d5096-261">Date</span><span class="sxs-lookup"><span data-stu-id="d5096-261">Date</span></span>|<span data-ttu-id="d5096-262">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-262">DateTime</span></span>|
||<span data-ttu-id="d5096-263">SByte</span><span class="sxs-lookup"><span data-stu-id="d5096-263">SByte</span></span>|<span data-ttu-id="d5096-264">Das Ableiten von <xref:System.Data.SqlDbType> aus SByte wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-264">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="d5096-265">TinyInt</span><span class="sxs-lookup"><span data-stu-id="d5096-265">TinyInt</span></span>|<span data-ttu-id="d5096-266">Das Ableiten von `OdbcType` aus SByte wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-266">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="d5096-267">SByte</span><span class="sxs-lookup"><span data-stu-id="d5096-267">SByte</span></span>|
||<span data-ttu-id="d5096-268">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="d5096-268">StringFixedLength</span></span>|<span data-ttu-id="d5096-269">NChar</span><span class="sxs-lookup"><span data-stu-id="d5096-269">NChar</span></span>|<span data-ttu-id="d5096-270">WChar</span><span class="sxs-lookup"><span data-stu-id="d5096-270">WChar</span></span>|<span data-ttu-id="d5096-271">NChar</span><span class="sxs-lookup"><span data-stu-id="d5096-271">NChar</span></span>|<span data-ttu-id="d5096-272">NChar</span><span class="sxs-lookup"><span data-stu-id="d5096-272">NChar</span></span>|
||<span data-ttu-id="d5096-273">Zeit</span><span class="sxs-lookup"><span data-stu-id="d5096-273">Time</span></span>|<span data-ttu-id="d5096-274">"Time" in SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="d5096-274">Time in SQL Server 2008.</span></span> <span data-ttu-id="d5096-275">Das Ableiten von <xref:System.Data.SqlDbType> aus Time wird erst ab SQL Server 2008 unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-275">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="d5096-276">DBTime</span><span class="sxs-lookup"><span data-stu-id="d5096-276">DBTime</span></span>|<span data-ttu-id="d5096-277">Time</span><span class="sxs-lookup"><span data-stu-id="d5096-277">Time</span></span>|<span data-ttu-id="d5096-278">Datetime</span><span class="sxs-lookup"><span data-stu-id="d5096-278">DateTime</span></span>|
||<span data-ttu-id="d5096-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="d5096-279">VarNumeric</span></span>|<span data-ttu-id="d5096-280">Das Ableiten von <xref:System.Data.SqlDbType> aus VarNumeric wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-280">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="d5096-281">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="d5096-281">VarNumeric</span></span>|<span data-ttu-id="d5096-282">Das Ableiten von `OdbcType` aus VarNumeric wird nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="d5096-282">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="d5096-283">Number</span><span class="sxs-lookup"><span data-stu-id="d5096-283">Number</span></span>|
|<span data-ttu-id="d5096-284">Benutzerdefinierter Typ (ein Objekt mit <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>)</span><span class="sxs-lookup"><span data-stu-id="d5096-284">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="d5096-285">Object oder String, je nach Anbieter (SqlClient gibt immer ein Objekt zurück, ODBC immer eine Zeichenfolge, und der verwaltete OLE DB-Datenanbieter ist in der Lage, beide zu erkennen).</span><span class="sxs-lookup"><span data-stu-id="d5096-285">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="d5096-286">SqlDbType.Udt, wenn <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> vorhanden ist; andernfalls Variant</span><span class="sxs-lookup"><span data-stu-id="d5096-286">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="d5096-287">OleDbType.VarWChar (wenn der Wert NULL ist); andernfalls OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="d5096-287">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="d5096-288">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="d5096-288">OdbcType.NVarChar</span></span>|<span data-ttu-id="d5096-289">wird nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="d5096-289">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="d5096-290">Beim Konvertieren von "decimal" in einen anderen Typ erhalten Sie nur eine annähernde Entsprechung, da der Wert auf die nächste Ganzzahl abgerundet wird.</span><span class="sxs-lookup"><span data-stu-id="d5096-290">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="d5096-291">Wenn das Ergebnis der Konvertierung im Zieltyp nicht darstellbar ist, wird eine <xref:System.OverflowException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="d5096-291">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="d5096-292">Wenn Sie einen NULL-Parameterwert an den Server senden, müssen Sie <xref:System.DBNull> und nicht `null` (in Visual Basic `Nothing`)+++ angeben.</span><span class="sxs-lookup"><span data-stu-id="d5096-292">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="d5096-293">Der NULL-Wert im System ist ein leeres Objekt, das keinen Wert aufweist.</span><span class="sxs-lookup"><span data-stu-id="d5096-293">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="d5096-294"><xref:System.DBNull> wird verwendet, um NULL-Werte darstellen.</span><span class="sxs-lookup"><span data-stu-id="d5096-294"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="d5096-295">Weitere Informationen zu Daten Bank Nullen finden Sie unter [Behandeln von NULL-Werten](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="d5096-295">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="d5096-296">Ableiten von Parameterinformationen</span><span class="sxs-lookup"><span data-stu-id="d5096-296">Deriving parameter information</span></span>

<span data-ttu-id="d5096-297">Parameter können auch mit der `DbCommandBuilder` -Klasse aus einer gespeicherten Prozedur abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="d5096-297">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="d5096-298">Sowohl die `SqlCommandBuilder` -Klasse als auch die `OleDbCommandBuilder` -Klasse stellen die statische Methode `DeriveParameters`bereit, die automatisch die Parameterauflistung eines Befehlsobjekts füllt, das Parameterinformationen aus einer gespeicherten Prozedur verwendet.</span><span class="sxs-lookup"><span data-stu-id="d5096-298">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="d5096-299">Beachten Sie, dass `DeriveParameters` alle vorhandenen Parameterinformationen für den Befehl überschreibt.</span><span class="sxs-lookup"><span data-stu-id="d5096-299">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="d5096-300">Das Ableiten von Parameterinformationen geht mit einem Leistungsverlust einher, weil zum Abrufen der Informationen ein zusätzlicher Roundtrip durch die Datenquelle erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="d5096-300">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="d5096-301">Wenn die Parameterinformationen zur Entwurfszeit bekannt sind, können Sie die Leistung der Anwendung verbessern, indem Sie die Parameter explizit festlegen.</span><span class="sxs-lookup"><span data-stu-id="d5096-301">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="d5096-302">Weitere Informationen finden Sie unter [Erstellen von Befehlen mit CommandBuilder](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="d5096-302">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="d5096-303">Verwenden von Parametern mit einem SqlCommand und einer gespeicherten Prozedur</span><span class="sxs-lookup"><span data-stu-id="d5096-303">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="d5096-304">Gespeicherte Prozeduren bieten zahlreiche Vorteile in datengesteuerten Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="d5096-304">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="d5096-305">Mit gespeicherten Prozeduren können Datenbankoperationen in einem einzelnen Befehl zusammengefasst, für die beste Leistung optimiert und mit zusätzlicher Sicherheit ausgestattet werden.</span><span class="sxs-lookup"><span data-stu-id="d5096-305">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="d5096-306">Obwohl eine gespeicherte Prozedur aufgerufen werden kann, indem der Name der gespeicherten Prozedur gefolgt von Parameter Argumenten als SQL-Anweisung übergeben wird, ermöglicht Ihnen die Verwendung der-Auflistung <xref:System.Data.Common.DbCommand.Parameters%2A> des ADO.net- <xref:System.Data.Common.DbCommand> Objekts das explizite Definieren von Parametern gespeicherter Prozeduren und den Zugriff auf Ausgabeparameter und Rückgabewerte.</span><span class="sxs-lookup"><span data-stu-id="d5096-306">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="d5096-307">Parametrisierte Anweisungen werden auf dem Server mit `sp_executesql,` ausgeführt, sodass die Wiederverwendung von Abfrageplänen möglich ist.</span><span class="sxs-lookup"><span data-stu-id="d5096-307">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="d5096-308">Lokale Cursor oder Variablen im `sp_executesql` -Batch sind für den Batch, der `sp_executesql`aufruft, nicht sichtbar.</span><span class="sxs-lookup"><span data-stu-id="d5096-308">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="d5096-309">Änderungen am Datenbankkontext sind nur bis zum Ende der `sp_executesql` -Anweisung gültig.</span><span class="sxs-lookup"><span data-stu-id="d5096-309">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="d5096-310">Weitere Informationen finden Sie unter [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="d5096-310">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="d5096-311">Wenn Sie Parameter mit einem <xref:System.Data.SqlClient.SqlCommand> verwenden, um eine gespeicherte SQL Server-Prozedur auszuführen, müssen die der <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> -Auflistung hinzugefügten Parameternamen mit den Namen der Parametermarkierungen in der gespeicherten Prozedur übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="d5096-311">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="d5096-312">Der .NET Framework-Datenanbieter für SQL Server unterstützt keine Fragezeichenplatzhalter (?) für die Übergabe von Parametern an eine SQL-Anweisung oder gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="d5096-312">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="d5096-313">Er behandelt die Parameter in der gespeicherten Prozedur als benannte Parameter und sucht nach den entsprechenden Parametermarkierungen.</span><span class="sxs-lookup"><span data-stu-id="d5096-313">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="d5096-314">Nehmen wir z. B. an, die gespeicherte Prozedur `CustOrderHist` ist mit einem Parameter mit dem Namen `@CustomerID`definiert.</span><span class="sxs-lookup"><span data-stu-id="d5096-314">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="d5096-315">Wenn Ihr Code die gespeicherte Prozedur ausführt, muss er ebenfalls einen Parameter mit dem Namen `@CustomerID`verwenden.</span><span class="sxs-lookup"><span data-stu-id="d5096-315">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="d5096-316">Beispiel</span><span class="sxs-lookup"><span data-stu-id="d5096-316">Example</span></span>

<span data-ttu-id="d5096-317">Dieses Beispiel zeigt, wie Sie eine gespeicherte SQL Server-Prozedur in der `Northwind` -Beispieldatenbank aufrufen können.</span><span class="sxs-lookup"><span data-stu-id="d5096-317">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="d5096-318">Der Name der gespeicherten Prozedur ist `dbo.SalesByCategory` , und die Prozedur besitzt einen Eingabeparameter mit dem Namen `@CategoryName` und dem Datentyp `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="d5096-318">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="d5096-319">Der Code erstellt eine neue <xref:System.Data.SqlClient.SqlConnection> innerhalb eines verwendeten Blocks, sodass die Verbindung nach dem Ende der Prozedur verworfen wird.</span><span class="sxs-lookup"><span data-stu-id="d5096-319">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="d5096-320">Es werden die Objekte <xref:System.Data.SqlClient.SqlCommand> und <xref:System.Data.SqlClient.SqlParameter> erstellt, und deren Eigenschaften werden festgelegt.</span><span class="sxs-lookup"><span data-stu-id="d5096-320">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="d5096-321">Ein <xref:System.Data.SqlClient.SqlDataReader> führt den `SqlCommand` aus und gibt den Resultset aus der gespeicherten Prozedur zurück, wobei die Ausgabe im Konsolenfenster angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="d5096-321">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="d5096-322">Statt die Objekte `SqlCommand` und `SqlParameter` zu erstellen und dann die Eigenschaften in separaten Anweisungen festzulegen, können Sie auch mit einem der überladenen Konstruktoren mehrere Eigenschaften in einer einzigen Anweisung festlegen.</span><span class="sxs-lookup"><span data-stu-id="d5096-322">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="d5096-323">Verwenden von Parametern mit einem "OleDbCommand" oder "OdbcCommand"</span><span class="sxs-lookup"><span data-stu-id="d5096-323">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="d5096-324">Wenn Sie Parameter mit einem <xref:System.Data.OleDb.OleDbCommand> oder einem <xref:System.Data.Odbc.OdbcCommand>verwenden, muss die Reihenfolge der der `Parameters` -Auflistung hinzugefügten Parameter mit der Reihenfolge der in der gespeicherten Prozedur definierten Parameter übereinstimmen.</span><span class="sxs-lookup"><span data-stu-id="d5096-324">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="d5096-325">Der .NET Framework-Datenanbieter für OLE DB und der .NET Framework-Datenanbieter für ODBC behandeln Parameter in einer gespeicherten Prozedur als Platzhalter und wenden Parameterwerte der Reihe nach an.</span><span class="sxs-lookup"><span data-stu-id="d5096-325">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="d5096-326">Außerdem müssen der `Parameters` -Auflistung zuerst die Parameter für die Rückgabewerte hinzugefügt werden.</span><span class="sxs-lookup"><span data-stu-id="d5096-326">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="d5096-327">Der .NET Framework-Datenanbieter für OLE DB und der .NET Framework-Datenanbieter für ODBC unterstützen keine benannten Parameter für die Übergabe von Parametern an eine SQL-Anweisung oder gespeicherte Prozedur.</span><span class="sxs-lookup"><span data-stu-id="d5096-327">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="d5096-328">In diesem Fall muss der Fragezeichenplatzhalter (?) verwenden. Dies wird im folgenden Beispiel dargestellt.</span><span class="sxs-lookup"><span data-stu-id="d5096-328">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="d5096-329">Dementsprechend muss die Reihenfolge, in der `Parameter` -Objekte der `Parameters` -Auflistung hinzugefügt werden, genau der Position des als Platzhalter für den Parameter fungierenden Fragezeichens (?)</span><span class="sxs-lookup"><span data-stu-id="d5096-329">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="d5096-330">entsprechen.</span><span class="sxs-lookup"><span data-stu-id="d5096-330">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="d5096-331">OLE DB-Beispiel</span><span class="sxs-lookup"><span data-stu-id="d5096-331">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="d5096-332">Beispiel zu "Odbc"</span><span class="sxs-lookup"><span data-stu-id="d5096-332">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="d5096-333">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="d5096-333">See also</span></span>

- [<span data-ttu-id="d5096-334">Befehle und Parameter</span><span class="sxs-lookup"><span data-stu-id="d5096-334">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="d5096-335">DataAdapter-Parameter</span><span class="sxs-lookup"><span data-stu-id="d5096-335">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="d5096-336">Datentypzuordnungen in ADO.NET</span><span class="sxs-lookup"><span data-stu-id="d5096-336">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="d5096-337">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="d5096-337">ADO.NET Overview</span></span>](ado-net-overview.md)
