---
title: Typäquivalenz und eingebettete Interop-Typen
description: In diesem Artikel erhalten Sie Informationen zur Typäquivalenz zwischen .NET-Typen sowie Membern mit verwalteter Assembly und COM-Typen, die in diese Assembly eingebettet sind. Für .NET 4 und höher.
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
ms.openlocfilehash: 2d572133c42f01af7d50f6f771588f5173853f9a
ms.sourcegitcommit: 97ce5363efa88179dd76e09de0103a500ca9b659
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/13/2020
ms.locfileid: "86282007"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="63eff-104">Typäquivalenz und eingebettete Interop-Typen</span><span class="sxs-lookup"><span data-stu-id="63eff-104">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="63eff-105">Ab .NET Framework 4 unterstützt die Common Language Runtime die Einbettung von Typinformationen für COM-Typen direkt in verwaltete Assemblys. Die verwalteten Assemblys müssen die Typinformationen für COM-Typen nicht aus Interopassemblys abrufen.</span><span class="sxs-lookup"><span data-stu-id="63eff-105">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="63eff-106">Da die eingebettete Typinformation nur die Typen und Member enthält, die tatsächlich von einer verwalteten Assembly verwendet werden, können zwei verwaltete Assemblys möglicherweise sehr unterschiedliche Ansichten desselben COM-Typs haben.</span><span class="sxs-lookup"><span data-stu-id="63eff-106">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="63eff-107">Jede verwaltete Assembly besitzt ein anderes <xref:System.Type>-Objekt, das eine Ansicht des COM-Typs darstellt.</span><span class="sxs-lookup"><span data-stu-id="63eff-107">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="63eff-108">Die Common Language Runtime unterstützt Typäquivalenz zwischen diesen unterschiedlichen Ansichten für Schnittstellen, Strukturen, Enumerationen und Delegaten.</span><span class="sxs-lookup"><span data-stu-id="63eff-108">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="63eff-109">Typäquivalenz bedeutet, dass ein COM-Objekt, das von einer verwalteten Assembly an eine andere übergeben wird, für den entsprechenden verwalteten Typ in der empfangenden Assembly bereitgestellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="63eff-109">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="63eff-110">Typäquivalenz und eingebettete Interop-Typen vereinfachen die Bereitstellung von Anwendungen und Add-Ins, die COM-Komponenten verwenden, da Interop-Assemblys nicht mit den Anwendungen bereitgestellt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="63eff-110">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="63eff-111">Entwickler von freigegebenen COM-Komponenten müssen noch primäre Interop-Assemblys (PIAs) erstellen, wenn ihre Komponenten von früheren Versionen von .NET Framework verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="63eff-111">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="63eff-112">Typäquivalenz</span><span class="sxs-lookup"><span data-stu-id="63eff-112">Type equivalence</span></span>

 <span data-ttu-id="63eff-113">Die Äquivalenz von COM-Typen wird für Schnittstellen, Strukturen, Enumerationen und Delegaten unterstützt.</span><span class="sxs-lookup"><span data-stu-id="63eff-113">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="63eff-114">COM-Typen gelten als äquivalent, wenn alle folgenden Bedingungen erfüllt sind:</span><span class="sxs-lookup"><span data-stu-id="63eff-114">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="63eff-115">Beide Typen sind sowohl Schnittstellen, Strukturen, Enumerationen oder Delegaten.</span><span class="sxs-lookup"><span data-stu-id="63eff-115">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="63eff-116">Beide Typen haben die gleiche Identität, wie im nächsten Abschnitt beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="63eff-116">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="63eff-117">Beide Typen sind für die Typäquivalenz berechtigt, wie im Abschnitt [Markieren von COM-Typen für Typäquivalenz](#marking-com-types-for-type-equivalence) beschrieben wird.</span><span class="sxs-lookup"><span data-stu-id="63eff-117">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="63eff-118">Typidentität</span><span class="sxs-lookup"><span data-stu-id="63eff-118">Type identity</span></span>

<span data-ttu-id="63eff-119">Zwei Typen werden die gleiche Identität haben, wenn ihre Bereiche und Identitäten übereinstimmen, das heißt, wenn sie beide über das <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>-Attribut verfügen, und die zwei Attribute übereinstimmende <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A>- und <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>-Eigenschaften aufweisen.</span><span class="sxs-lookup"><span data-stu-id="63eff-119">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="63eff-120">Beim Vergleich für <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> wird die Groß- und Kleinschreibung nicht berücksichtigt.</span><span class="sxs-lookup"><span data-stu-id="63eff-120">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="63eff-121">Wenn ein Typ nicht über das <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>-Attribut, oder über ein <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>-Attribut verfügt, das Bereich und Bezeichner nicht angibt, kann der Typ folgendermaßen weiterhin für die Äquivalenz in Betracht gezogen werden:</span><span class="sxs-lookup"><span data-stu-id="63eff-121">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="63eff-122">Für Schnittstellen wird der Wert von <xref:System.Runtime.InteropServices.GuidAttribute> anstelle der <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType>-Eigenschaft verwendet, und die <xref:System.Type.FullName%2A?displayProperty=nameWithType>-Eigenschaft (d.h. Typnamen einschließlich Namespace) wird anstelle der <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType>-Eigenschaft verwendet.</span><span class="sxs-lookup"><span data-stu-id="63eff-122">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="63eff-123">Bei Strukturen, Enumerationen und Delegaten wird die <xref:System.Runtime.InteropServices.GuidAttribute> der enthaltenden Assembly anstelle der <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A>-Eigenschaft, und die <xref:System.Type.FullName%2A?displayProperty=nameWithType>-Eigenschaft anstelle der <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>-Eigenschaft verwendet.</span><span class="sxs-lookup"><span data-stu-id="63eff-123">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="63eff-124">Markieren von COM-Typen für Typäquivalenz</span><span class="sxs-lookup"><span data-stu-id="63eff-124">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="63eff-125">Sie können einen Typ auf zwei Arten für Typäquivalenz verfügbar kennzeichnen:</span><span class="sxs-lookup"><span data-stu-id="63eff-125">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="63eff-126">Fügen Sie das <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>-Attribut zum Typ hinzu.</span><span class="sxs-lookup"><span data-stu-id="63eff-126">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="63eff-127">Machen Sie den Typ zu einem COM-Importtyp.</span><span class="sxs-lookup"><span data-stu-id="63eff-127">Make the type a COM import type.</span></span> <span data-ttu-id="63eff-128">Eine Schnittstelle ist eine COM-Importtyp, wenn es über das <xref:System.Runtime.InteropServices.ComImportAttribute>-Attribut verfügt.</span><span class="sxs-lookup"><span data-stu-id="63eff-128">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="63eff-129">Eine Schnittstelle, Struktur, Enumeration oder ein Delegat ist ein COM-Importtyp, wenn die Assembly, in der sie definiert ist, über das <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>-Attribut verfügt.</span><span class="sxs-lookup"><span data-stu-id="63eff-129">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="63eff-130">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="63eff-130">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="63eff-131">[Verwenden von COM-Typen in verwaltetem Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="63eff-131">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="63eff-132">Importing a Type Library as an Assembly (Importieren einer Typbibliothek als Assembly)</span><span class="sxs-lookup"><span data-stu-id="63eff-132">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)
