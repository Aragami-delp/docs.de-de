---
title: Runtime Callable Wrapper (RCW)
ms.date: 03/30/2017
helpviewer_keywords:
- COM interop, COM wrappers
- RCW
- COM wrappers
- runtime callable wrappers
- interoperation with unmanaged code, COM wrappers
ms.assetid: 7e542583-1e31-4e10-b523-8cf2f29cb4a4
ms.openlocfilehash: 0b448379fba965060fdf3bf067e65374f40d1fc2
ms.sourcegitcommit: 00aa62e2f469c2272a457b04e66b4cc3c97a800b
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 02/28/2020
ms.locfileid: "78156009"
---
# <a name="runtime-callable-wrapper"></a><span data-ttu-id="6cfb2-102">Runtime Callable Wrapper (RCW)</span><span class="sxs-lookup"><span data-stu-id="6cfb2-102">Runtime Callable Wrapper</span></span>
<span data-ttu-id="6cfb2-103">Die Common Language Runtime macht COM-Objekte über einen Proxy verfügbar, der RCW (Runtime Callable Wrapper, Aufrufwrapper der Common Language Runtime) genannt wird.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-103">The common language runtime exposes COM objects through a proxy called the runtime callable wrapper (RCW).</span></span> <span data-ttu-id="6cfb2-104">Obwohl .NET-Clients einen RCW als normales Objekt betrachten, besteht seine primäre Funktion im Marshallen von Aufrufen zwischen einem .NET-Client und einem COM-Objekt.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-104">Although the RCW appears to be an ordinary object to .NET clients, its primary function is to marshal calls between a .NET client and a COM object.</span></span>  
  
 <span data-ttu-id="6cfb2-105">Die Common Language Runtime erstellt genau einen RCW für jedes COM-Objekt, unabhängig von der Anzahl der vorhandenen Verweise auf das Objekt.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-105">The runtime creates exactly one RCW for each COM object, regardless of the number of references that exist on that object.</span></span> <span data-ttu-id="6cfb2-106">Die Common Language Runtime verwaltet für jedes Objekt einen einzelnen RCW pro Prozess.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-106">The runtime maintains a single RCW per process for each object.</span></span>  <span data-ttu-id="6cfb2-107">Wenn Sie einen RCW in einer Anwendungsdomäne oder einem Apartment erstellen und anschließend einen Verweis an eine andere Anwendungsdomäne oder ein anderes Apartment übergeben, wird ein Proxy für das erste Objekt verwendet.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-107">If you create an RCW in one application domain or apartment, and then pass a reference to another application domain or apartment, a proxy to the first object will be used.</span></span>  <span data-ttu-id="6cfb2-108">Wie die folgende Abbildung zeigt, kann eine beliebige Anzahl verwalteter Clients auf die COM-Objekte verweisen, welche die Schnittstellen "INew" und "INewer" verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-108">As the following illustration shows, any number of managed clients can hold a reference to the COM objects that expose INew and INewer interfaces.</span></span>  

<span data-ttu-id="6cfb2-109">Die folgende Abbildung veranschaulicht, wie über den RCW auf COM-Objekte zugegriffen wird:</span><span class="sxs-lookup"><span data-stu-id="6cfb2-109">The following image shows the process for accessing COM objects through the runtime callable wrapper:</span></span>

 ![Zugriff auf COM-Objekte über den RCW](./media/runtime-callable-wrapper/runtime-callable-wrapper.gif)  

 <span data-ttu-id="6cfb2-111">Mithilfe von Metadaten, die aus einer Typbibliothek abgeleitet werden, erstellt die Common Language Runtime sowohl das aufzurufende COM-Objekt als auch einen Wrapper für dieses Objekt.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-111">Using metadata derived from a type library, the runtime creates both the COM object being called and a wrapper for that object.</span></span> <span data-ttu-id="6cfb2-112">Jeder RCW verwaltet einen Cache von Schnittstellenzeigern auf das umschlossene COM-Objekt. Ist der RCW nicht länger erforderlich, wird der jeweilige Verweis auf das COM-Objekt freigegeben.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-112">Each RCW maintains a cache of interface pointers on the COM object it wraps and releases its reference on the COM object when the RCW is no longer needed.</span></span> <span data-ttu-id="6cfb2-113">Die Common Language Runtime führt eine Garbage Collection für den RCW durch.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-113">The runtime performs garbage collection on the RCW.</span></span>  
  
 <span data-ttu-id="6cfb2-114">Unter anderem marshallt der RCW für das umschlossene Objekt Daten zwischen verwaltetem und nicht verwaltetem Code.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-114">Among other activities, the RCW marshals data between managed and unmanaged code, on behalf of the wrapped object.</span></span> <span data-ttu-id="6cfb2-115">Insbesondere marshallt der RCW Methodenargumente und von Methoden zurückgegebene Werte, wenn der Client und der Server die untereinander ausgetauschten Daten unterschiedlich darstellen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-115">Specifically, the RCW provides marshaling for method arguments and method return values whenever the client and server have different representations of the data passed between them.</span></span>  
  
 <span data-ttu-id="6cfb2-116">Der Standardwrapper erzwingt integrierte Marshallregeln.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-116">The standard wrapper enforces built-in marshaling rules.</span></span> <span data-ttu-id="6cfb2-117">Wenn beispielsweise ein .NET-Client einen Zeichenfolgetyp als Teil eines Arguments an ein nicht verwaltetes Objekt übergibt, konvertiert der Wrapper die Zeichenfolge in einen BSTR-Typ.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-117">For example, when a .NET client passes a String type as part of an argument to an unmanaged object, the wrapper converts the string to a BSTR type.</span></span> <span data-ttu-id="6cfb2-118">Gibt das COM-Objekt seinem verwalteten Aufrufer einen BSTR zurück, erhält der Aufrufer eine Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-118">Should the COM object return a BSTR to its managed caller, the caller receives a String.</span></span> <span data-ttu-id="6cfb2-119">Sowohl der Client als auch der Server senden und empfangen auf diese Weise Daten, die ihnen jeweils vertraut sind.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-119">Both the client and the server send and receive data that is familiar to them.</span></span> <span data-ttu-id="6cfb2-120">Andere Typen erfordern keine Konvertierung.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-120">Other types require no conversion.</span></span> <span data-ttu-id="6cfb2-121">Ein Standardwrapper überträgt z. B. eine ganze Zahl von 4 Byte zwischen verwaltetem und nicht verwaltetem Code immer ohne Typkonvertierung.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-121">For instance, a standard wrapper will always pass a 4-byte integer between managed and unmanaged code without converting the type.</span></span>  
  
## <a name="marshaling-selected-interfaces"></a><span data-ttu-id="6cfb2-122">Marshallen von ausgewählten Schnittstellen</span><span class="sxs-lookup"><span data-stu-id="6cfb2-122">Marshaling selected interfaces</span></span>  
 <span data-ttu-id="6cfb2-123">Die Hauptaufgabe des RCW ([Runtime Callable Wrapper](runtime-callable-wrapper.md)) besteht darin, die Unterschiede zwischen den verwalteten und nicht verwalteten Programmiermodellen unsichtbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-123">The primary goal of the [runtime callable wrapper](runtime-callable-wrapper.md) (RCW) is to hide the differences between the managed and unmanaged programming models.</span></span> <span data-ttu-id="6cfb2-124">Um einen nahtlosen Übergang zu gewährleisten, beansprucht der RCW ausgewählte COM-Schnittstellen, ohne diese für den .NET-Client verfügbar zu machen. Dies ist in der folgenden Abbildung dargestellt.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-124">To create a seamless transition, the RCW consumes selected COM interfaces without exposing them to the .NET client, as shown in the following illustration.</span></span>

 <span data-ttu-id="6cfb2-125">Die folgende Abbildung zeigt COM-Schnittstellen und den RCW:</span><span class="sxs-lookup"><span data-stu-id="6cfb2-125">The following image shows COM interfaces and the runtime callable wrapper:</span></span>
  
 ![Screenshot des RCW mit Schnittstellen](./media/runtime-callable-wrapper/runtime-callable-wrapper-interfaces.gif)  
  
 <span data-ttu-id="6cfb2-127">Ein RCW, der als früh gebundenes Objekt erstellt wurde, stellt einen bestimmten Typ dar.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-127">When created as an early-bound object, the RCW is a specific type.</span></span> <span data-ttu-id="6cfb2-128">Dieser implementiert die Schnittstellen für das COM-Objekt und macht die Methoden, Eigenschaften und Ereignisse der Schnittstellen des Objekts verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-128">It implements the interfaces that the COM object implements and exposes the methods, properties, and events from the object's interfaces.</span></span> <span data-ttu-id="6cfb2-129">In der Abbildung macht der RCW die Schnittstelle „INew“ verfügbar, beansprucht jedoch die Schnittstellen **IUnknown** und **IDispatch**.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-129">In the illustration, the RCW exposes the INew interface but consumes the **IUnknown** and **IDispatch** interfaces.</span></span> <span data-ttu-id="6cfb2-130">Darüber hinaus macht der RCW dem .NET-Client alle Member der Schnittstelle "INew" verfügbar.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-130">Further, the RCW exposes all members of the INew interface to the .NET client.</span></span>  
  
 <span data-ttu-id="6cfb2-131">Der RCW beansprucht die in der folgenden Tabelle aufgelisteten Schnittstellen, die durch das umschlossene Objekt verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-131">The RCW consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="6cfb2-132">Interface</span><span class="sxs-lookup"><span data-stu-id="6cfb2-132">Interface</span></span>|<span data-ttu-id="6cfb2-133">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="6cfb2-133">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="6cfb2-134">**IDispatch**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-134">**IDispatch**</span></span>|<span data-ttu-id="6cfb2-135">Regelt späte Bindung an COM-Objekte durch Reflektion.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-135">For late binding to COM objects through reflection.</span></span>|  
|<span data-ttu-id="6cfb2-136">**IErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-136">**IErrorInfo**</span></span>|<span data-ttu-id="6cfb2-137">Stellt eine Textbeschreibung des Fehlers und der Fehlerquelle, eine Hilfedatei, den Hilfekontext und die GUID der Schnittstelle bereit, die den Fehler definiert hat (bei .NET-Klassen immer **GUID_NULL**).</span><span class="sxs-lookup"><span data-stu-id="6cfb2-137">Provides a textual description of the error, its source, a Help file, Help context, and the GUID of the interface that defined the error (always **GUID_NULL** for .NET classes).</span></span>|  
|<span data-ttu-id="6cfb2-138">**IProvideClassInfo**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-138">**IProvideClassInfo**</span></span>|<span data-ttu-id="6cfb2-139">Wenn das COM-Objekt, das umschlossen wird, **IProvideClassInfo** implementiert, extrahiert der RCW die Typinformationen über diese Schnittstelle, um eine bessere Typidentität bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-139">If the COM object being wrapped implements **IProvideClassInfo**, the RCW extracts the type information from this interface to provide better type identity.</span></span>|  
|<span data-ttu-id="6cfb2-140">**IUnknown**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-140">**IUnknown**</span></span>|<span data-ttu-id="6cfb2-141">Wird für Objektidentität, Typkoersion und Verwaltung der Lebensdauer verwendet:</span><span class="sxs-lookup"><span data-stu-id="6cfb2-141">For object identity, type coercion, and lifetime management:</span></span><br /><br /> <span data-ttu-id="6cfb2-142">– Objektidentität</span><span class="sxs-lookup"><span data-stu-id="6cfb2-142">-   Object identity</span></span><br />     <span data-ttu-id="6cfb2-143">Die Common Language Runtime unterscheidet zwischen COM-Objekten, indem der Wert der Schnittstelle **IUnknown** für jedes Objekt verglichen wird.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-143">The runtime distinguishes between COM objects by comparing the value of the **IUnknown** interface for each object.</span></span><br /><span data-ttu-id="6cfb2-144">– Typkoersion</span><span class="sxs-lookup"><span data-stu-id="6cfb2-144">-   Type coercion</span></span><br />     <span data-ttu-id="6cfb2-145">Der RCW erkennt die dynamische Typermittlung durch die Methode **QueryInterface**.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-145">The RCW recognizes the dynamic type discovery performed by the **QueryInterface** method.</span></span><br /><span data-ttu-id="6cfb2-146">– Verwaltung der Lebensdauer</span><span class="sxs-lookup"><span data-stu-id="6cfb2-146">-   Lifetime management</span></span><br />     <span data-ttu-id="6cfb2-147">Mithilfe der Methode **QueryInterface** erhält der RCW einen Verweis auf ein nicht verwaltetes Objekt und hält diesen aufrecht, bis die Common Language Runtime eine Garbage Collection auf den Wrapper durchführt. Dadurch wird das nicht verwaltete Objekt freigegeben.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-147">Using the **QueryInterface** method, the RCW gets and holds a reference to an unmanaged object until the runtime performs garbage collection on the wrapper, which releases the unmanaged object.</span></span>|  
  
 <span data-ttu-id="6cfb2-148">Der RCW beansprucht optional die in der folgenden Tabelle aufgelisteten Schnittstellen, die durch das umschlossene Objekt verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-148">The RCW optionally consumes the interfaces listed in the following table, which are exposed by the object it wraps.</span></span>  
  
|<span data-ttu-id="6cfb2-149">Interface</span><span class="sxs-lookup"><span data-stu-id="6cfb2-149">Interface</span></span>|<span data-ttu-id="6cfb2-150">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="6cfb2-150">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="6cfb2-151">**IConnectionPoint** und **IConnectionPointContainer**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-151">**IConnectionPoint** and **IConnectionPointContainer**</span></span>|<span data-ttu-id="6cfb2-152">Der RCW konvertiert Objekte, die Ereignisformate für Verbindungspunkte gegenüber delegatbasierten Ereignissen verfügbar machen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-152">The RCW converts objects that expose the connection-point event style to delegate-based events.</span></span>|  
|<span data-ttu-id="6cfb2-153">**IDispatchEx** (nur .NET Framework)</span><span class="sxs-lookup"><span data-stu-id="6cfb2-153">**IDispatchEx** (.NET Framework Only)</span></span> |<span data-ttu-id="6cfb2-154">Wenn die Klasse **IDispatchEx** implementiert, implementiert der RCW **IExpando**.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-154">If the class implements **IDispatchEx**, the RCW implements **IExpando**.</span></span> <span data-ttu-id="6cfb2-155">Die **IDispatchEx**-Schnittstelle ist eine Erweiterung der **IDispatch**-Schnittstelle. Im Gegensatz zu **IDispatch** ermöglicht sie das Aufzählen, Hinzufügen, Löschen und Aufrufen von Membern unter Berücksichtigung von Groß-/Kleinschreibung.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-155">The **IDispatchEx** interface is an extension of the **IDispatch** interface that, unlike **IDispatch**, enables enumeration, addition, deletion, and case-sensitive calling of members.</span></span>|  
|<span data-ttu-id="6cfb2-156">**IEnumVARIANT**</span><span class="sxs-lookup"><span data-stu-id="6cfb2-156">**IEnumVARIANT**</span></span>|<span data-ttu-id="6cfb2-157">Aktiviert COM-Typen, die die Behandlung von Enumerationen als Auflistungen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="6cfb2-157">Enables COM types that support enumerations to be treated as collections.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="6cfb2-158">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="6cfb2-158">See also</span></span>

- [<span data-ttu-id="6cfb2-159">COM-Wrapper</span><span class="sxs-lookup"><span data-stu-id="6cfb2-159">COM Wrappers</span></span>](com-wrappers.md)
- [<span data-ttu-id="6cfb2-160">COM Callable Wrapper</span><span class="sxs-lookup"><span data-stu-id="6cfb2-160">COM Callable Wrapper</span></span>](com-callable-wrapper.md)
- <span data-ttu-id="6cfb2-161">[Zusammenfassung: Konvertieren einer Typbibliothek in eine Assembly](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="6cfb2-161">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="6cfb2-162">Importing a Type Library as an Assembly (Importieren einer Typbibliothek als Assembly)</span><span class="sxs-lookup"><span data-stu-id="6cfb2-162">Importing a Type Library as an Assembly</span></span>](../../framework/interop/importing-a-type-library-as-an-assembly.md)
