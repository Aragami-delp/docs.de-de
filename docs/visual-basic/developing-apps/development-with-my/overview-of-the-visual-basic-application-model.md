---
title: Übersicht über das Visual Basic-Anwendungsmodell
ms.date: 07/20/2015
helpviewer_keywords:
- My.Application object [Visual Basic], Visual Basic application model
- Visual Basic application model
ms.assetid: 17538984-84fe-43c9-82c8-724c9529fe8b
ms.openlocfilehash: 46177d0af7e5df767eb8421caf424880baac615e
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 06/04/2020
ms.locfileid: "84411726"
---
# <a name="overview-of-the-visual-basic-application-model"></a><span data-ttu-id="19e5a-102">Übersicht über das Visual Basic-Anwendungsmodell</span><span class="sxs-lookup"><span data-stu-id="19e5a-102">Overview of the Visual Basic Application Model</span></span>

<span data-ttu-id="19e5a-103">Visual Basic bietet mit dem Visual Basic-Anwendungsmodell ein klar definiertes Modell zur Steuerung des Verhaltens von Windows Forms-Anwendungen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-103">Visual Basic provides a well-defined model for controlling the behavior of Windows Forms applications: the Visual Basic Application model.</span></span> <span data-ttu-id="19e5a-104">Dieses Modell enthält Ereignisse, um den Start und das Herunterfahren der Anwendung zu verarbeiten sowie zum Abfangen von Ausnahmefehlern.</span><span class="sxs-lookup"><span data-stu-id="19e5a-104">This model includes events for handling the application's startup and shutdown, as well as events for catching unhandled exceptions.</span></span> <span data-ttu-id="19e5a-105">Es bietet auch Unterstützung für die Entwicklung von Einzelinstanzanwendungen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-105">It also provides support for developing single-instance applications.</span></span> <span data-ttu-id="19e5a-106">Da das Anwendungsmodell zudem erweiterbar ist, können Entwickler, die mehr Kontrolle benötigen, die überschreibbaren Methoden anpassen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-106">The application model is extensible, so developers that need more control can customize its overridable methods.</span></span>  
  
## <a name="uses-for-the-application-model"></a><span data-ttu-id="19e5a-107">Verwendungsmöglichkeiten für das Anwendungsmodell</span><span class="sxs-lookup"><span data-stu-id="19e5a-107">Uses for the Application Model</span></span>  

 <span data-ttu-id="19e5a-108">In der Regel führt eine Anwendung beim Starten und beim Herunterfahren Aufgaben aus.</span><span class="sxs-lookup"><span data-stu-id="19e5a-108">A typical application needs to perform tasks when it starts up and shuts down.</span></span> <span data-ttu-id="19e5a-109">Beispielsweise kann sie beim Starten einen Begrüßungsbildschirm anzeigen, Datenbankverbindungen herstellen oder einen gespeicherten Zustand laden.</span><span class="sxs-lookup"><span data-stu-id="19e5a-109">For example, when it starts up, the application can display a splash screen, make database connections, load a saved state, and so on.</span></span> <span data-ttu-id="19e5a-110">Beim Herunterfahren kann die Anwendung etwa Datenbankverbindungen schließen, den aktuellen Zustand speichern usw.</span><span class="sxs-lookup"><span data-stu-id="19e5a-110">When the application shuts down, it can close database connections, save the current state, and so on.</span></span> <span data-ttu-id="19e5a-111">Außerdem kann die Anwendung einen bestimmten Code ausführen, wenn sie unerwartet heruntergefahren wird, z. B. bei einem Ausnahmefehler.</span><span class="sxs-lookup"><span data-stu-id="19e5a-111">In addition, the application can execute specific code when the application shuts down unexpectedly, such as during an unhandled exception.</span></span>  
  
 <span data-ttu-id="19e5a-112">Mithilfe des Visual Basic-Anwendungsmodells können Sie ganz einfach eine *Einzelinstanzanwendung* erstellen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-112">The Visual Basic Application model makes it easy to create a *single-instance* application.</span></span> <span data-ttu-id="19e5a-113">Eine Einzelinstanzanwendung unterscheidet sich von einer normalen Anwendung dadurch, dass jeweils nur eine Instanz der Anwendung ausgeführt werden kann.</span><span class="sxs-lookup"><span data-stu-id="19e5a-113">A single-instance application differs from a normal application in that only one instance of the application can be running at a time.</span></span> <span data-ttu-id="19e5a-114">Der Versuch, eine weitere Instanz einer Einzelinstanzanwendung zu starten, führt dazu, dass die ursprüngliche Instanz mithilfe des Ereignisses `StartupNextInstance` darüber informiert wird, dass ein weiterer Startversuch durchgeführt wurde.</span><span class="sxs-lookup"><span data-stu-id="19e5a-114">An attempt to launch another instance of a single-instance application results in the original instance being notified—by means of the `StartupNextInstance` event—that another launch attempt was made.</span></span> <span data-ttu-id="19e5a-115">Die Benachrichtigung enthält die Befehlszeilenargumente der nachfolgenden Instanz.</span><span class="sxs-lookup"><span data-stu-id="19e5a-115">The notification includes the subsequent instance's command-line arguments.</span></span> <span data-ttu-id="19e5a-116">Bevor eine Initialisierung erfolgen kann, wird die nachfolgende Instanz der Anwendung geschlossen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-116">The subsequent instance of the application is then closed before any initialization can occur.</span></span>  
  
 <span data-ttu-id="19e5a-117">Eine Einzelinstanzanwendung überprüft nach dem Start, ob sie die erste Instanz oder eine nachfolgende Instanz der Anwendung ist:</span><span class="sxs-lookup"><span data-stu-id="19e5a-117">A single-instance application starts and checks whether it is the first instance or a subsequent instance of the application:</span></span>  
  
- <span data-ttu-id="19e5a-118">Handelt es sich um die erste Instanz, wird die Anwendung wie üblich gestartet.</span><span class="sxs-lookup"><span data-stu-id="19e5a-118">If it is the first instance, it starts as usual.</span></span>  
  
- <span data-ttu-id="19e5a-119">Jeder nachfolgende Versuch, die Anwendung während der Ausführung der ersten Instanz zu starten, führt zu einem ganz anderen Verhalten.</span><span class="sxs-lookup"><span data-stu-id="19e5a-119">Each subsequent attempt to start the application, while the first instance runs, results in very different behavior.</span></span> <span data-ttu-id="19e5a-120">Die nachfolgende Instanz übergibt die Befehlszeilenargumente an die erste Instanz und wird dann sofort beendet.</span><span class="sxs-lookup"><span data-stu-id="19e5a-120">The subsequent attempt notifies the first instance about the command-line arguments, and then immediately exits.</span></span> <span data-ttu-id="19e5a-121">Die erste Instanz verarbeitet das Ereignis `StartupNextInstance` zur Bestimmung der Befehlszeilenargumente der nachfolgenden Instanz und wird weiter ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="19e5a-121">The first instance handles the `StartupNextInstance` event to determine what the subsequent instance's command-line arguments were, and continues to run.</span></span>  
  
     <span data-ttu-id="19e5a-122">Im folgenden Diagramm wird die Signalübergabe von der nachfolgenden Instanz an die erste Instanz dargestellt:</span><span class="sxs-lookup"><span data-stu-id="19e5a-122">This diagram shows how a subsequent instance signals the first instance:</span></span>  
  
     ![Diagramm einer Einzelinstanzanwendung](./media/overview-of-the-visual-basic-application-model/single-instance-application.gif)  
  
 <span data-ttu-id="19e5a-124">Über die Behandlung des Ereignisses `StartupNextInstance` können Sie steuern, wie sich die Einzelinstanzanwendung verhalten soll.</span><span class="sxs-lookup"><span data-stu-id="19e5a-124">By handling the `StartupNextInstance` event, you can control how your single-instance application behaves.</span></span> <span data-ttu-id="19e5a-125">Microsoft Outlook wird z. B. in der Regel als Einzelinstanzanwendung ausgeführt. Wenn Sie nun versuchen, Outlook erneut zu starten, obwohl es bereits ausgeführt wird, wechselt der Fokus auf die ursprüngliche Instanz, es wird jedoch keine weitere Instanz geöffnet.</span><span class="sxs-lookup"><span data-stu-id="19e5a-125">For example, Microsoft Outlook typically runs as a single-instance application; when Outlook is running and you attempt to start Outlook again, focus shifts to the original instance but another instance does not open.</span></span>  
  
## <a name="events-in-the-application-model"></a><span data-ttu-id="19e5a-126">Ereignisse im Anwendungsmodell</span><span class="sxs-lookup"><span data-stu-id="19e5a-126">Events in the Application Model</span></span>  

 <span data-ttu-id="19e5a-127">Folgende Ereignisse können im Anwendungsmodell auftreten:</span><span class="sxs-lookup"><span data-stu-id="19e5a-127">The following events are found in the application model:</span></span>  
  
- <span data-ttu-id="19e5a-128">**Starten der Anwendung**:</span><span class="sxs-lookup"><span data-stu-id="19e5a-128">**Application startup**.</span></span> <span data-ttu-id="19e5a-129">Beim Startvorgang löst die Anwendung das Ereignis <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> aus.</span><span class="sxs-lookup"><span data-stu-id="19e5a-129">The application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup> event when it starts.</span></span> <span data-ttu-id="19e5a-130">Bei der Behandlung dieses Ereignisses können Sie Code hinzufügen, durch den die Anwendung vor dem Laden des Hauptformulars initialisiert wird.</span><span class="sxs-lookup"><span data-stu-id="19e5a-130">By handling this event, you can add code that initializes the application before the main form is loaded.</span></span> <span data-ttu-id="19e5a-131">Über das `Startup`-Ereignis können Sie die Ausführung der Anwendung in dieser Phase des Startvorgangs gegebenenfalls auch abbrechen.</span><span class="sxs-lookup"><span data-stu-id="19e5a-131">The `Startup` event also provides for canceling execution of the application during that phase of the startup process, if desired.</span></span>  
  
     <span data-ttu-id="19e5a-132">Sie können die Anwendung so konfigurieren, dass während der Ausführung des Startcodes ein Begrüßungsbildschirm angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="19e5a-132">You can configure the application to show a splash screen while the application startup code runs.</span></span> <span data-ttu-id="19e5a-133">Standardmäßig wird der Begrüßungsbildschirm vom Anwendungsmodell unterdrückt, wenn eines der beiden Befehlszeilenargumente `/nosplash` oder `-nosplash` verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="19e5a-133">By default, the application model suppresses the splash screen when either the `/nosplash` or `-nosplash` command-line argument is used.</span></span>  
  
- <span data-ttu-id="19e5a-134">**Einzelinstanzanwendungen**:</span><span class="sxs-lookup"><span data-stu-id="19e5a-134">**Single-instance applications**.</span></span> <span data-ttu-id="19e5a-135">Wird eine nachfolgende Instanz einer Einzelinstanzanwendung gestartet, wird das Ereignis <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="19e5a-135">The <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance> event is raised when a subsequent instance of a single-instance application starts.</span></span> <span data-ttu-id="19e5a-136">Dieses übergibt die Befehlszeilenargumente der nachfolgenden Instanz.</span><span class="sxs-lookup"><span data-stu-id="19e5a-136">The event passes the command-line arguments of the subsequent instance.</span></span>  
  
- <span data-ttu-id="19e5a-137">**Ausnahmefehler**:</span><span class="sxs-lookup"><span data-stu-id="19e5a-137">**Unhandled exceptions**.</span></span> <span data-ttu-id="19e5a-138">Bei einem Ausnahmefehler wird das Ereignis <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="19e5a-138">If the application encounters an unhandled exception, it raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException> event.</span></span> <span data-ttu-id="19e5a-139">Der Handler für dieses Ereignis kann die Ausnahme untersuchen und entscheiden, ob die Ausführung fortgesetzt werden soll.</span><span class="sxs-lookup"><span data-stu-id="19e5a-139">Your handler for that event can examine the exception and determine whether to continue execution.</span></span>  
  
     <span data-ttu-id="19e5a-140">Unter bestimmten Umständen wird das Ereignis `UnhandledException` nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="19e5a-140">The `UnhandledException` event is not raised in some circumstances.</span></span> <span data-ttu-id="19e5a-141">Weitere Informationen finden Sie unter <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>.</span><span class="sxs-lookup"><span data-stu-id="19e5a-141">For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>.</span></span>  
  
- <span data-ttu-id="19e5a-142">**Änderungen der Netzwerkkonnektivität**:</span><span class="sxs-lookup"><span data-stu-id="19e5a-142">**Network-connectivity changes**.</span></span> <span data-ttu-id="19e5a-143">Bei Änderungen der Verfügbarkeit des Computernetzwerks wird das Ereignis <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="19e5a-143">If the computer's network availability changes, the application raises the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged> event.</span></span>  
  
     <span data-ttu-id="19e5a-144">Unter bestimmten Umständen wird das Ereignis `NetworkAvailabilityChanged` nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="19e5a-144">The `NetworkAvailabilityChanged` event is not raised in some circumstances.</span></span> <span data-ttu-id="19e5a-145">Weitere Informationen finden Sie unter <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>.</span><span class="sxs-lookup"><span data-stu-id="19e5a-145">For more information, see <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>.</span></span>  
  
- <span data-ttu-id="19e5a-146">**Herunterfahren der Anwendung**:</span><span class="sxs-lookup"><span data-stu-id="19e5a-146">**Application shut down**.</span></span> <span data-ttu-id="19e5a-147">Über das Ereignis <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> signalisiert die Anwendung, dass sie gleich heruntergefahren wird.</span><span class="sxs-lookup"><span data-stu-id="19e5a-147">The application provides the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown> event to signal when it is about to shut down.</span></span> <span data-ttu-id="19e5a-148">In diesem Ereignishandler können Sie festlegen, dass die erforderlichen Vorgänge (wie z. B. Schließen und Speichern) auch abgeschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="19e5a-148">In that event handler, you can make sure that the operations your application needs to perform—closing and saving, for example—are completed.</span></span> <span data-ttu-id="19e5a-149">Sie können die Anwendung so konfigurieren, dass sie beim Schließen des Hauptformulars heruntergefahren wird oder erst dann, wenn alle Formulare geschlossen werden.</span><span class="sxs-lookup"><span data-stu-id="19e5a-149">You can configure your application to shut down when the main form closes, or to shut down only when all forms close.</span></span>  
  
## <a name="availability"></a><span data-ttu-id="19e5a-150">Verfügbarkeit</span><span class="sxs-lookup"><span data-stu-id="19e5a-150">Availability</span></span>  

 <span data-ttu-id="19e5a-151">Das Visual Basic-Anwendungsmodell ist standardmäßig für Windows Forms-Projekte verfügbar.</span><span class="sxs-lookup"><span data-stu-id="19e5a-151">By default, the Visual Basic Application model is available for Windows Forms projects.</span></span> <span data-ttu-id="19e5a-152">Wenn Sie für die Anwendung ein anderes Startobjekt konfigurieren, oder wenn Sie den Anwendungscode mit einer benutzerdefinierten `Sub Main`-Klasse starten, muss das Objekt bzw. die Klasse möglicherweise eine Implementierung der Klasse <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase>bereitstellen, um das Anwendungsmodell verwenden zu können.</span><span class="sxs-lookup"><span data-stu-id="19e5a-152">If you configure the application to use a different startup object, or start the application code with a custom `Sub Main`, then that object or class may need to provide an implementation of the <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase> class to use the application model.</span></span> <span data-ttu-id="19e5a-153">Informationen zum Ändern des Startobjekts finden Sie unter [Seite „Anwendung“, Projekt-Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic).</span><span class="sxs-lookup"><span data-stu-id="19e5a-153">For information about changing the startup object, see [Application Page, Project Designer (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="19e5a-154">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="19e5a-154">See also</span></span>

- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Startup>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.StartupNextInstance>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.UnhandledException>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.Shutdown>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase.NetworkAvailabilityChanged>
- <xref:Microsoft.VisualBasic.ApplicationServices.WindowsFormsApplicationBase>
- [<span data-ttu-id="19e5a-155">Erweitern des Visual Basic-Anwendungsmodells</span><span class="sxs-lookup"><span data-stu-id="19e5a-155">Extending the Visual Basic Application Model</span></span>](../customizing-extending-my/extending-the-visual-basic-application-model.md)
