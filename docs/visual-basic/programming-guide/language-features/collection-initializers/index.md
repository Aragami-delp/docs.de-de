---
title: Auflistungsinitialisierer
ms.date: 07/20/2015
f1_keywords:
- vb.CollectionInitializer
helpviewer_keywords:
- collection initializers [Visual Basic]
ms.assetid: a9290329-77b0-4fdf-ae75-8fc17287f469
ms.openlocfilehash: 1d2d5adc7266faaa1636e568d6433429761eeaab
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/04/2020
ms.locfileid: "84414543"
---
# <a name="collection-initializers-visual-basic"></a><span data-ttu-id="629ba-102">Auflistungsinitialisierer (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="629ba-102">Collection Initializers (Visual Basic)</span></span>

<span data-ttu-id="629ba-103">*Auflistungsinitialisierer* stellen eine gekürzte Syntax bereit, mit der Sie eine Auflistung erstellen und mit einem anfänglichen Satz von Werten auffüllen können.</span><span class="sxs-lookup"><span data-stu-id="629ba-103">*Collection initializers* provide a shortened syntax that enables you to create a collection and populate it with an initial set of values.</span></span> <span data-ttu-id="629ba-104">Auflistungsinitialisierer sind nützlich beim Erstellen einer Auflistung aus einem Satz unbekannter Werte, z.B. eine Liste von Menüoptionen oder Kategorien, ein ursprünglicher Satz numerischer Werte, eine statische Liste von Zeichenfolgen wie Tag- oder Monatsnamen oder geografische Orte, z.B. eine Liste von Staaten, die für eine Überprüfung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="629ba-104">Collection initializers are useful when you are creating a collection from a set of known values, for example, a list of menu options or categories, an initial set of numeric values, a static list of strings such as day or month names, or geographic locations such as a list of states that is used for validation.</span></span>

<span data-ttu-id="629ba-105">Weitere Informationen über Auflistungen finden Sie unter [Auflistungen](../../concepts/collections.md).</span><span class="sxs-lookup"><span data-stu-id="629ba-105">For more information about collections, see [Collections](../../concepts/collections.md).</span></span>

<span data-ttu-id="629ba-106">Sie identifizieren einen Auflistungsinitialisierer durch Gebrauch des Schlüsselworts `From`, gefolgt von Klammern (`{}`).</span><span class="sxs-lookup"><span data-stu-id="629ba-106">You identify a collection initializer by using the `From` keyword followed by braces (`{}`).</span></span> <span data-ttu-id="629ba-107">Dies hat eine Ähnlichkeit mit der Arrayliteralsyntax, die unter [Arrays](../arrays/index.md) beschrieben ist.</span><span class="sxs-lookup"><span data-stu-id="629ba-107">This is similar to the array literal syntax that is described in [Arrays](../arrays/index.md).</span></span> <span data-ttu-id="629ba-108">Die folgenden Beispiele stellen unterschiedliche Möglichkeiten für die Verwendung von Auflistungsinitialisierern für die Erstellung von Auflistungen dar.</span><span class="sxs-lookup"><span data-stu-id="629ba-108">The following examples show various ways to use collection initializers to create collections.</span></span>

[!code-vb[VbVbalrCollectionInitializers#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#1)]

> [!NOTE]
> <span data-ttu-id="629ba-109">C# stellt ebenso Auflistungsinitialisierer bereit.</span><span class="sxs-lookup"><span data-stu-id="629ba-109">C# also provides collection initializers.</span></span> <span data-ttu-id="629ba-110">C#-Auflistungsinitialisierer bieten die gleichen Funktionen wie Visual Basic-Auflistungsinitialisierer.</span><span class="sxs-lookup"><span data-stu-id="629ba-110">C# collection initializers provide the same functionality as Visual Basic collection initializers.</span></span> <span data-ttu-id="629ba-111">Informationen über C#-Auflistungsinitialisierer finden Sie unter [Objekt- und Auflistungsinitialisierer](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span><span class="sxs-lookup"><span data-stu-id="629ba-111">For more information about C# collection initializers, see [Object and Collection Initializers](../../../../csharp/programming-guide/classes-and-structs/object-and-collection-initializers.md).</span></span>

## <a name="syntax"></a><span data-ttu-id="629ba-112">Syntax</span><span class="sxs-lookup"><span data-stu-id="629ba-112">Syntax</span></span>

<span data-ttu-id="629ba-113">Ein Auflistungsinitialisierer besteht aus einer Liste von durch Komma getrennte Werte, die in Klammern (`{}`) eingeschlossen sind. Das Schlüsselwort `From` ist vorangestellt, wie im folgenden Code dargestellt.</span><span class="sxs-lookup"><span data-stu-id="629ba-113">A collection initializer consists of a list of comma-separated values that are enclosed in braces (`{}`), preceded by the `From` keyword, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#2)]

<span data-ttu-id="629ba-114">Wenn Sie eine Auflistung erstellen, z.B. <xref:System.Collections.Generic.List%601> oder <xref:System.Collections.Generic.Dictionary%602>, müssen Sie den Auflistungstyp vor dem Auflistungsinitialisierer angeben, so wie im folgenden Code dargestellt.</span><span class="sxs-lookup"><span data-stu-id="629ba-114">When you create a collection, such as a <xref:System.Collections.Generic.List%601> or a <xref:System.Collections.Generic.Dictionary%602>, you must supply the collection type before the collection initializer, as shown in the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#13)]

> [!NOTE]
> <span data-ttu-id="629ba-115">Sie können nicht einen Auflistungsinitialisierer und einen Objektinitialisierer kombinieren, um das gleiche Auflistungsobjekt zu initialisieren.</span><span class="sxs-lookup"><span data-stu-id="629ba-115">You cannot combine both a collection initializer and an object initializer to initialize the same collection object.</span></span> <span data-ttu-id="629ba-116">Sie können Objektinitialisierer zum Initialisieren von Objekten in einem Auflistungsinitialisierer verwenden.</span><span class="sxs-lookup"><span data-stu-id="629ba-116">You can use object initializers to initialize objects in a collection initializer.</span></span>

## <a name="creating-a-collection-by-using-a-collection-initializer"></a><span data-ttu-id="629ba-117">Erstellen einer Sammlung mithilfe eines sammlungsinitialisierers</span><span class="sxs-lookup"><span data-stu-id="629ba-117">Creating a Collection by Using a Collection Initializer</span></span>

<span data-ttu-id="629ba-118">Wenn Sie eine Sammlung durch Verwendung eines Auflistunsinitialisierers erstellen, wird jeder Wert, der im Auflistunsinitialisierer angegeben ist, an die entsprechende `Add`-Methode der Auflistung übergeben.</span><span class="sxs-lookup"><span data-stu-id="629ba-118">When you create a collection by using a collection initializer, each value that is supplied in the collection initializer is passed to the appropriate `Add` method of the collection.</span></span> <span data-ttu-id="629ba-119">Wenn Sie z.B. eine <xref:System.Collections.Generic.List%601> durch Verwendung eines Auflistungsinitialisierers erstellen, wird jeder Zeichenfolgenwert im Auflistungsinitialisierer an die <xref:System.Collections.Generic.List%601.Add%2A>-Methode übergeben.</span><span class="sxs-lookup"><span data-stu-id="629ba-119">For example, if you create a <xref:System.Collections.Generic.List%601> by using a collection initializer, each string value in the collection initializer is passed to the <xref:System.Collections.Generic.List%601.Add%2A> method.</span></span> <span data-ttu-id="629ba-120">Wenn Sie eine Auflistung mithilfe eines Auflistungsinitialisierers erstellen möchten, muss der angegebene Typ ein gültiger Auflistungstyp sein.</span><span class="sxs-lookup"><span data-stu-id="629ba-120">If you want to create a collection by using a collection initializer, the specified type must be valid collection type.</span></span> <span data-ttu-id="629ba-121">Beispiele gültiger Auflistungstypen enthalten Klassen, die die <xref:System.Collections.Generic.IEnumerable%601>-Schnittstelle implementieren oder die <xref:System.Collections.CollectionBase>-Klasse erben.</span><span class="sxs-lookup"><span data-stu-id="629ba-121">Examples of valid collection types include classes that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or inherit the <xref:System.Collections.CollectionBase> class.</span></span> <span data-ttu-id="629ba-122">Der angegebene Typ muss auch eine `Add`-Methode verfügbar machen, die die folgenden Kriterien erfüllt.</span><span class="sxs-lookup"><span data-stu-id="629ba-122">The specified type must also expose an `Add` method that meets the following criteria.</span></span>

- <span data-ttu-id="629ba-123">Die `Add`-Methode muss aus dem Bereich verfügbar sein, aus dem der Auflistungsinitialisierer aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="629ba-123">The `Add` method must be available from the scope in which the collection initializer is being called.</span></span> <span data-ttu-id="629ba-124">Die `Add`-Methode muss öffentlich sein, wenn Sie den Auflistungsinitialisierer in einem Szenario verwenden, in dem auf nicht-öffentliche Methode der Auflistung zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="629ba-124">The `Add` method does not have to be public if you are using the collection initializer in a scenario where non-public methods of the collection can be accessed.</span></span>

- <span data-ttu-id="629ba-125">Die `Add`-Methode muss ein Instanzmember oder `Shared`-Member der Auflistungsklasse sein oder eine Erweiterungsmethode.</span><span class="sxs-lookup"><span data-stu-id="629ba-125">The `Add` method must be an instance member or `Shared` member of the collection class, or an extension method.</span></span>

- <span data-ttu-id="629ba-126">Es muss eine `Add`-Methode existieren, die auf Basis von Regeln der Überladungsauflösung mit den Typen verglichen werden kann, die im Auflistungsinitialisierer bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="629ba-126">An `Add` method must exist that can be matched, based on overload resolution rules, to the types that are supplied in the collection initializer.</span></span>

 <span data-ttu-id="629ba-127">Beispielsweise wird im folgenden Codebeispiel gezeigt, wie eine `List(Of Customer)`-Auflistung mithilfe eines Auflistungsinitialisierers erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="629ba-127">For example, the following code example shows how to create a `List(Of Customer)` collection by using a collection initializer.</span></span> <span data-ttu-id="629ba-128">Wenn der Code ausgeführt wird, wird jedes `Customer`-Objekt an die `Add(Customer)`-Methode der generischen Liste übergeben.</span><span class="sxs-lookup"><span data-stu-id="629ba-128">When the code is run, each `Customer` object is passed to the `Add(Customer)` method of the generic list.</span></span>

[!code-vb[VbVbalrCollectionInitializers#9](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#9)]

<span data-ttu-id="629ba-129">Das folgende Codebeispiel zeigt gleichwertigen Code, der keinen Auflistungsinitialisierer verwendet.</span><span class="sxs-lookup"><span data-stu-id="629ba-129">The following code example shows equivalent code that does not use a collection initializer.</span></span>

[!code-vb[VbVbalrCollectionInitializers#10](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#10)]

<span data-ttu-id="629ba-130">Wenn die Auflistung über eine `Add`-Methode verfügt, die Parameter besitzt, die mit dem Konstruktor für das `Customer`-Objekt übereinstimmen, können Sie Parameterwerte für die `Add`-Methode innerhalb von Auflistungsinitialisierern schachteln, so wie im nächsten Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="629ba-130">If the collection has an `Add` method that has parameters that match the constructor for the `Customer` object, you could nest parameter values for the `Add` method within collection initializers, as discussed in the next section.</span></span> <span data-ttu-id="629ba-131">Wenn die Auflistung nicht über diese `Add`-Methode verfügt, können Sie eine als Erweiterungsmethode erstellen.</span><span class="sxs-lookup"><span data-stu-id="629ba-131">If the collection does not have such an `Add` method, you can create one as an extension method.</span></span> <span data-ttu-id="629ba-132">Ein Beispiel, wie Sie eine `Add`-Methode als Sammlung für eine Auflistung erstellen, finden Sie unter [Vorgehensweise: Erstellen einer Add-Erweiterungsmethode für einen Auflistungsinitialisierer](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="629ba-132">For an example of how to create an `Add` method as an extension method for a collection, see [How to: Create an Add Extension Method Used by a Collection Initializer](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md).</span></span> <span data-ttu-id="629ba-133">Ein Beispiel, wie Sie eine benutzerdefinierte Auflistung erstellen, die mit einem Auflistungsinitialisierer verwendet werden kann, finden Sie unter [Vorgehensweise: Erstellen einer Auflistung für einen Auflistungsinitialisierer](how-to-create-a-collection-used-by-a-collection-initializer.md).</span><span class="sxs-lookup"><span data-stu-id="629ba-133">For an example of how to create a custom collection that can be used with a collection initializer, see [How to: Create a Collection Used by a Collection Initializer](how-to-create-a-collection-used-by-a-collection-initializer.md).</span></span>

## <a name="nesting-collection-initializers"></a><span data-ttu-id="629ba-134">Schachteln von Auflistungsinitialisierern</span><span class="sxs-lookup"><span data-stu-id="629ba-134">Nesting Collection Initializers</span></span>

<span data-ttu-id="629ba-135">Sie können Werte innerhalb eines Auflistungsinitialisierers schachteln, um eine bestimmte Überladung einer `Add`-Methode für die Auflistung, die erstellt wird, zu identifizieren.</span><span class="sxs-lookup"><span data-stu-id="629ba-135">You can nest values within a collection initializer to identify a specific overload of an `Add` method for the collection that is being created.</span></span> <span data-ttu-id="629ba-136">Die Werte, die an die `Add`-Methode übergeben werden, müssen durch Kommas getrennt und in Klammern (`{}`) eingeschlossen werden, so wie Sie das auch in einem Arrayliteral oder Auflistungsinitialisierer tun würden.</span><span class="sxs-lookup"><span data-stu-id="629ba-136">The values passed to the `Add` method must be separated by commas and enclosed in braces (`{}`), like you would do in an array literal or collection initializer.</span></span>

<span data-ttu-id="629ba-137">Wenn Sie ein Auflistung mithilfe geschachtelter Werte erstellen, wird jedes Element der geschachtelten Werteliste an das Argument an die `Add`-Methode übergeben, die mit den Elementtypen übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="629ba-137">When you create a collection by using nested values, each element of the nested value list is passed as an argument to the `Add` method that matches the element types.</span></span> <span data-ttu-id="629ba-138">Beispielsweise erstellt das folgende Codebeispiel eine <xref:System.Collections.Generic.Dictionary%602>, in der die Schlüssel vom Typ `Integer` und die Werte vom Typ `String` sind.</span><span class="sxs-lookup"><span data-stu-id="629ba-138">For example, the following code example creates a <xref:System.Collections.Generic.Dictionary%602> in which the keys are of type `Integer` and the values are of type `String`.</span></span> <span data-ttu-id="629ba-139">Jede der geschachtelten Wertelisten wird mit der <xref:System.Collections.Generic.Dictionary%602.Add%2A>-Methode für `Dictionary` verglichen.</span><span class="sxs-lookup"><span data-stu-id="629ba-139">Each of the nested value lists is matched to the <xref:System.Collections.Generic.Dictionary%602.Add%2A> method for the `Dictionary`.</span></span>

[!code-vb[VbVbalrCollectionInitializers#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#5)]

<span data-ttu-id="629ba-140">Das vorherige Codebeispiel entspricht dem folgenden Code.</span><span class="sxs-lookup"><span data-stu-id="629ba-140">The previous code example is equivalent to the following code.</span></span>

[!code-vb[VbVbalrCollectionInitializers#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#6)]

<span data-ttu-id="629ba-141">Es werden ausschließlich geschachtelte Wertelisten aus der ersten Schachtelungsebene an die `Add`-Methode für den Auflistungstyp gesendet.</span><span class="sxs-lookup"><span data-stu-id="629ba-141">Only nested value lists from the first level of nesting are sent to the `Add` method for the collection type.</span></span> <span data-ttu-id="629ba-142">Tiefere Schachtelungsebenen werden als Arrayliterale behandelt und die geschachtelten Wertelisten werden der `Add`-Methode einer Auflistung nicht zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="629ba-142">Deeper levels of nesting are treated as array literals and the nested value lists are not matched to the `Add` method of any collection.</span></span>

## <a name="related-topics"></a><span data-ttu-id="629ba-143">Verwandte Themen</span><span class="sxs-lookup"><span data-stu-id="629ba-143">Related Topics</span></span>

|<span data-ttu-id="629ba-144">Titel</span><span class="sxs-lookup"><span data-stu-id="629ba-144">Title</span></span>|<span data-ttu-id="629ba-145">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="629ba-145">Description</span></span>|
|---|---|
|[<span data-ttu-id="629ba-146">Vorgehensweise: Erstellen einer Add-Erweiterungsmethode für einen Auflistungsinitialisierer</span><span class="sxs-lookup"><span data-stu-id="629ba-146">How to: Create an Add Extension Method Used by a Collection Initializer</span></span>](how-to-create-an-add-extension-method-used-by-a-collection-initializer.md)|<span data-ttu-id="629ba-147">Zeigt, wie eine Erweiterungsmethode namens `Add` erstellt wird, die zum Auffüllen einer Auflistung mit Werten von einem Auflistungsinitialisierer verwendet werden kann.</span><span class="sxs-lookup"><span data-stu-id="629ba-147">Shows how to create an extension method called `Add` that can be used to populate a collection with values from a collection initializer.</span></span>|
|[<span data-ttu-id="629ba-148">Vorgehensweise: Erstellen einer Auflistung für einen Auflistungsinitialisierer</span><span class="sxs-lookup"><span data-stu-id="629ba-148">How to: Create a Collection Used by a Collection Initializer</span></span>](how-to-create-a-collection-used-by-a-collection-initializer.md)|<span data-ttu-id="629ba-149">Zeigt, wie die Verwendung eines Auflistungsinitialisierers ermöglicht wird, indem eine `Add`-Methode in eine Auflistungsklasse eingefügt wird, die `IEnumerable` implementiert.</span><span class="sxs-lookup"><span data-stu-id="629ba-149">Shows how to enable use of a collection initializer by including an `Add` method in a collection class that implements `IEnumerable`.</span></span>|

## <a name="see-also"></a><span data-ttu-id="629ba-150">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="629ba-150">See also</span></span>

- [<span data-ttu-id="629ba-151">Sammlungen</span><span class="sxs-lookup"><span data-stu-id="629ba-151">Collections</span></span>](../../concepts/collections.md)
- [<span data-ttu-id="629ba-152">Arrays</span><span class="sxs-lookup"><span data-stu-id="629ba-152">Arrays</span></span>](../arrays/index.md)
- [<span data-ttu-id="629ba-153">Objektinitialisierer: benannte und anonyme Typen</span><span class="sxs-lookup"><span data-stu-id="629ba-153">Object Initializers: Named and Anonymous Types</span></span>](../objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="629ba-154">New-Operator</span><span class="sxs-lookup"><span data-stu-id="629ba-154">New Operator</span></span>](../../../language-reference/operators/new-operator.md)
- [<span data-ttu-id="629ba-155">Automatisch implementierte Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="629ba-155">Auto-Implemented Properties</span></span>](../procedures/auto-implemented-properties.md)
- <span data-ttu-id="629ba-156">[How to: Initialize an Array Variable in Visual Basic](../arrays/how-to-initialize-an-array-variable.md) (Gewusst wie: Initialisieren einer Arrayvariable in Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="629ba-156">[How to: Initialize an Array Variable in Visual Basic](../arrays/how-to-initialize-an-array-variable.md)</span></span>
- [<span data-ttu-id="629ba-157">Lokaler Typrückschluss</span><span class="sxs-lookup"><span data-stu-id="629ba-157">Local Type Inference</span></span>](../variables/local-type-inference.md)
- [<span data-ttu-id="629ba-158">Anonyme Typen</span><span class="sxs-lookup"><span data-stu-id="629ba-158">Anonymous Types</span></span>](../objects-and-classes/anonymous-types.md)
- [<span data-ttu-id="629ba-159">Einführung in LINQ in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="629ba-159">Introduction to LINQ in Visual Basic</span></span>](../linq/introduction-to-linq.md)
- [<span data-ttu-id="629ba-160">Vorgehensweise: Erstellen einer Liste von Elementen</span><span class="sxs-lookup"><span data-stu-id="629ba-160">How to: Create a List of Items</span></span>](../../concepts/linq/how-to-create-a-list-of-items.md)
